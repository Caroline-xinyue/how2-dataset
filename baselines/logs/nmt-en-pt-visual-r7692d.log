-------
[train]
-------
           device_id:auto_1
         num_workers:0
          pin_memory:False
                seed:1536107407
               gclip:1
              l2_reg:0
            patience:10
           optimizer:adam
                  lr:0.0004
            lr_decay:plateau
     lr_decay_revert:False
     lr_decay_factor:0.5
   lr_decay_patience:2
        lr_decay_min:1e-06
            momentum:0.0
            nesterov:False
           disp_freq:30
          batch_size:96
          max_epochs:100
      max_iterations:1000000
        eval_metrics:bleu,loss
        eval_filters:de-spm
           eval_beam:5
     eval_batch_size:32
           eval_freq:0
        eval_max_len:200
          eval_start:1
           eval_zero:False
   save_best_metrics:True
     checkpoint_freq:5000
       n_checkpoints:0
     tensorboard_dir:/lium/raid01_a/caglayan/models/jsalt/data-paper/tb_dir
     pretrained_file:/lium/raid01_a/caglayan/models/jsalt/data-paper/NMT-EN-PT/emb320-rnn320-8.34M/dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-rf0fa5-val050.best.bleu_54.270.ckpt
       freeze_layers:
          model_type:NMT
           save_path:/lium/raid01_a/caglayan/models/jsalt/data-paper
           subfolder:nmt-en-pt-320-320-adaptive
              exp_id:adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
-------
[model]
-------
            att_type:mlp
      att_bottleneck:hid
             emb_dim:320
             enc_dim:320
             dec_dim:320
          n_encoders:2
         dropout_emb:0.3
         dropout_ctx:0.3
         dropout_out:0.3
            tied_emb:2way
            dec_init:mean_ctx
           direction:en:Text, feats:Numpy -> pt:Text
           bucket_by:en
             max_len:120
          adaptation:True
      adaptation_dim:2048
    adaptation_activ:None
------
[data]
------
                root:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt
           train_set:
                    en:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/train_tr95/text.lc.nopunct.spm5000.en
                 feats:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/train_tr95/action_meanpool.npy
                    pt:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/train_tr95/text.lc.nopunct.spm5000.pt
             val_set:
                    en:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/train_cv05/text.lc.nopunct.spm5000.en
                 feats:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/train_cv05/action_meanpool.npy
                    pt:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/train_cv05/text.lc.nopunct.spm5000.pt
             dev_set:
                    en:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/dev_test/text.lc.nopunct.spm5000.en
                 feats:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/dev_test/action_meanpool.npy
                    pt:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/dev_test/text.lc.nopunct.spm5000.pt
            dev5_set:
                    en:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/dev5_test/text.lc.nopunct.spm5000.en
                 feats:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/dev5_test/action_meanpool.npy
                    pt:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/dev5_test/text.lc.nopunct.spm5000.pt
        held_out_set:
                    en:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/held_out_test/text.lc.nopunct.spm5000.en
                 feats:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/held_out_test/action_meanpool.npy
                    pt:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/held_out_test/text.lc.nopunct.spm5000.pt
------------
[vocabulary]
------------
                  en:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/train_tr95/text.lc.nopunct.spm5000.vocab.en
                  pt:/lium/raid01_a/caglayan/data/jsalt/howto-300h-slt/train_tr95/text.lc.nopunct.spm5000.vocab.pt
----------------------------------------------------------------------

PyTorch 0.3.1 (CUDA: 9.0.176) on 'gpu05' (GPUs: 0)
Nmtpytorch version: 1.5.0
Seed for further reproducibility: 1536107407
SLURM Job ID: 386755
Loading dataset(s)
163 samples rejected because of length filtering @ 120
MultimodalDataset - (2 sources / 1 targets)
Batches sorted by 'en' lengths
  Sources:
    --> TextDataset 'text.lc.nopunct.spm5000.en' (185187 sentences)
    --> NumpyDataset 'action_meanpool.npy' (185187 samples)
  Targets:
    --> TextDataset 'text.lc.nopunct.spm5000.pt' (185187 sentences)

MultimodalDataset - (2 sources / 1 targets)
Batches sorted by 'en' lengths
  Sources:
    --> TextDataset 'text.lc.nopunct.spm5000.en' (2022 sentences)
    --> NumpyDataset 'action_meanpool.npy' (2022 samples)
  Targets:
    --> TextDataset 'text.lc.nopunct.spm5000.pt' (2022 sentences)

MultimodalDataset - (2 sources / 0 targets)
Batches sorted by 'en' lengths
  Sources:
    --> TextDataset 'text.lc.nopunct.spm5000.en' (2022 sentences)
    --> NumpyDataset 'action_meanpool.npy' (2022 samples)

 -> will initialize dec.att.ctx2ctx.* with pretrained weights.
 -> will initialize dec.att.ctx2hid.* with pretrained weights.
 -> will initialize dec.att.hid2ctx.* with pretrained weights.
 -> will initialize dec.att.mlp.* with pretrained weights.
 -> will initialize dec.dec0.* with pretrained weights.
 -> will initialize dec.dec1.* with pretrained weights.
 -> will initialize dec.emb.* with pretrained weights.
 -> will initialize dec.ff_dec_init.* with pretrained weights.
 -> will initialize dec.hid2out.* with pretrained weights.
 -> will initialize dec.out2prob.* with pretrained weights.
 -> will initialize enc.emb.* with pretrained weights.
 -> will initialize enc.enc.* with pretrained weights.
NMT(
  (enc): TextEncoder(
    (do_emb): Dropout(p=0.3)
    (do_ctx): Dropout(p=0.3)
    (emb): Embedding(5001, 320, padding_idx=0)
    (enc): GRU(320, 320, num_layers=2, bidirectional=True)
  )
  (dec): ConditionalDecoder(
    (emb): Embedding(5001, 320, padding_idx=0)
    (att): Attention(
      (mlp): Linear(in_features=320, out_features=1, bias=False)
      (hid2ctx): Linear(in_features=320, out_features=320, bias=False)
      (ctx2ctx): Linear(in_features=640, out_features=320, bias=False)
      (ctx2hid): Linear(in_features=640, out_features=320, bias=False)
    )
    (ff_dec_init): FF(in_features=640, out_features=320, activ=tanh, bias=True, bias_zero=True)
    (dec0): GRUCell(320, 320)
    (dec1): GRUCell(320, 320)
    (do_out): Dropout(p=0.3)
    (hid2out): FF(in_features=320, out_features=320, activ=tanh, bias=True, bias_zero=True)
    (out2prob): FF(in_features=320, out_features=5001, activ=linear, bias=True, bias_zero=True)
    (nll_loss): NLLLoss(
    )
  )
  (vis_proj): FF(in_features=2048, out_features=320, activ=linear, bias=False, bias_zero=True)
)
Vocabulary of 5001 items (name=en)
Vocabulary of 5001 items (name=pt)
# parameters: 8.99M (8.99M learnable)

Optimizer => adam (lr: 0.0004, weight_decay: 0, g_clip: 1, lr_decay: (patience=2, factor=0.5))
TensorBoard is active
Memory usage before training: GeForce GTX 1080 Ti -> 567 MiB
Training started on 05-09-2018 02:30
Starting Epoch 1
Epoch 1 - update         30 => loss: 0.880 (used GPU: 2205 MiB)
Epoch 1 - update         60 => loss: 0.354 (used GPU: 2755 MiB)
Epoch 1 - update         90 => loss: 0.599 (used GPU: 2755 MiB)
Epoch 1 - update        120 => loss: 0.698 (used GPU: 2755 MiB)
Epoch 1 - update        150 => loss: 0.497 (used GPU: 2755 MiB)
Epoch 1 - update        180 => loss: 0.550 (used GPU: 2755 MiB)
Epoch 1 - update        210 => loss: 0.406 (used GPU: 2755 MiB)
Epoch 1 - update        240 => loss: 0.611 (used GPU: 2911 MiB)
Epoch 1 - update        270 => loss: 0.741 (used GPU: 2911 MiB)
Epoch 1 - update        300 => loss: 0.633 (used GPU: 2911 MiB)
Epoch 1 - update        330 => loss: 0.465 (used GPU: 2911 MiB)
Epoch 1 - update        360 => loss: 0.384 (used GPU: 2911 MiB)
Epoch 1 - update        390 => loss: 1.013 (used GPU: 2911 MiB)
Epoch 1 - update        420 => loss: 0.788 (used GPU: 2911 MiB)
Epoch 1 - update        450 => loss: 0.663 (used GPU: 2911 MiB)
Epoch 1 - update        480 => loss: 0.808 (used GPU: 2911 MiB)
Epoch 1 - update        510 => loss: 0.597 (used GPU: 2911 MiB)
Epoch 1 - update        540 => loss: 0.332 (used GPU: 2911 MiB)
Epoch 1 - update        570 => loss: 0.576 (used GPU: 2911 MiB)
Epoch 1 - update        600 => loss: 0.195 (used GPU: 2911 MiB)
Epoch 1 - update        630 => loss: 0.262 (used GPU: 2911 MiB)
Epoch 1 - update        660 => loss: 0.787 (used GPU: 2911 MiB)
Epoch 1 - update        690 => loss: 0.608 (used GPU: 2911 MiB)
Epoch 1 - update        720 => loss: 0.294 (used GPU: 2911 MiB)
Epoch 1 - update        750 => loss: 0.643 (used GPU: 2911 MiB)
Epoch 1 - update        780 => loss: 0.329 (used GPU: 2911 MiB)
Epoch 1 - update        810 => loss: 0.627 (used GPU: 2911 MiB)
Epoch 1 - update        840 => loss: 0.457 (used GPU: 2911 MiB)
Epoch 1 - update        870 => loss: 0.420 (used GPU: 2933 MiB)
Epoch 1 - update        900 => loss: 0.538 (used GPU: 2933 MiB)
Epoch 1 - update        930 => loss: 1.010 (used GPU: 2933 MiB)
Epoch 1 - update        960 => loss: 1.040 (used GPU: 2933 MiB)
Epoch 1 - update        990 => loss: 0.780 (used GPU: 3029 MiB)
Epoch 1 - update       1020 => loss: 0.242 (used GPU: 3029 MiB)
Epoch 1 - update       1050 => loss: 0.341 (used GPU: 3029 MiB)
Epoch 1 - update       1080 => loss: 1.025 (used GPU: 3029 MiB)
Epoch 1 - update       1110 => loss: 0.555 (used GPU: 3029 MiB)
Epoch 1 - update       1140 => loss: 0.892 (used GPU: 3029 MiB)
Epoch 1 - update       1170 => loss: 0.869 (used GPU: 3029 MiB)
Epoch 1 - update       1200 => loss: 0.571 (used GPU: 3029 MiB)
Epoch 1 - update       1230 => loss: 0.565 (used GPU: 3029 MiB)
Epoch 1 - update       1260 => loss: 0.353 (used GPU: 3029 MiB)
Epoch 1 - update       1290 => loss: 0.449 (used GPU: 3029 MiB)
Epoch 1 - update       1320 => loss: 0.709 (used GPU: 3881 MiB)
Epoch 1 - update       1350 => loss: 0.752 (used GPU: 3881 MiB)
Epoch 1 - update       1380 => loss: 0.902 (used GPU: 3881 MiB)
Epoch 1 - update       1410 => loss: 0.435 (used GPU: 3881 MiB)
Epoch 1 - update       1440 => loss: 0.958 (used GPU: 3881 MiB)
Epoch 1 - update       1470 => loss: 0.488 (used GPU: 3881 MiB)
Epoch 1 - update       1500 => loss: 0.742 (used GPU: 3881 MiB)
Epoch 1 - update       1530 => loss: 0.986 (used GPU: 3881 MiB)
Epoch 1 - update       1560 => loss: 0.460 (used GPU: 3881 MiB)
Epoch 1 - update       1590 => loss: 0.387 (used GPU: 3881 MiB)
Epoch 1 - update       1620 => loss: 0.809 (used GPU: 3881 MiB)
Epoch 1 - update       1650 => loss: 0.650 (used GPU: 3881 MiB)
Epoch 1 - update       1680 => loss: 0.908 (used GPU: 3881 MiB)
Epoch 1 - update       1710 => loss: 0.644 (used GPU: 3881 MiB)
Epoch 1 - update       1740 => loss: 0.802 (used GPU: 3881 MiB)
Epoch 1 - update       1770 => loss: 0.619 (used GPU: 3881 MiB)
Epoch 1 - update       1800 => loss: 0.543 (used GPU: 3881 MiB)
Epoch 1 - update       1830 => loss: 0.470 (used GPU: 3881 MiB)
Epoch 1 - update       1860 => loss: 0.757 (used GPU: 3881 MiB)
Epoch 1 - update       1890 => loss: 0.505 (used GPU: 3881 MiB)
Epoch 1 - update       1920 => loss: 1.082 (used GPU: 4243 MiB)
Epoch 1 - update       1950 => loss: 0.440 (used GPU: 4243 MiB)
Epoch 1 - update       1980 => loss: 0.513 (used GPU: 4243 MiB)
--> Epoch 1 finished with mean loss 0.76938
--> Overhead/Training/Evaluation: 0.13/2.78/0.00 mins (total: 2.92 mins)   (1108 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.80 sec, Scoring: 0.37 sec (348 sent/sec)
Validation 1 -> LOSS = 1.13
Validation 1 -> MRR = 84.09
Validation 1 -> BLEU = 52.91, 76.4/58.9/46.7/37.3 (BP=1.000, ratio=1.009, hyp_len=34173, ref_len=33879)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.13 @ validation 1
--> Best MRR so far: 84.09 @ validation 1
--> Best BLEU so far: 52.91 @ validation 1
Starting Epoch 2
Epoch 2 - update       2010 => loss: 0.798 (used GPU: 4243 MiB)
Epoch 2 - update       2040 => loss: 0.837 (used GPU: 4243 MiB)
Epoch 2 - update       2070 => loss: 0.822 (used GPU: 4243 MiB)
Epoch 2 - update       2100 => loss: 0.707 (used GPU: 4243 MiB)
Epoch 2 - update       2130 => loss: 0.379 (used GPU: 4243 MiB)
Epoch 2 - update       2160 => loss: 0.484 (used GPU: 4243 MiB)
Epoch 2 - update       2190 => loss: 0.436 (used GPU: 4243 MiB)
Epoch 2 - update       2220 => loss: 0.446 (used GPU: 4243 MiB)
Epoch 2 - update       2250 => loss: 0.724 (used GPU: 4243 MiB)
Epoch 2 - update       2280 => loss: 0.466 (used GPU: 4243 MiB)
Epoch 2 - update       2310 => loss: 0.341 (used GPU: 4243 MiB)
Epoch 2 - update       2340 => loss: 0.823 (used GPU: 4243 MiB)
Epoch 2 - update       2370 => loss: 0.242 (used GPU: 4243 MiB)
Epoch 2 - update       2400 => loss: 0.280 (used GPU: 4243 MiB)
Epoch 2 - update       2430 => loss: 0.336 (used GPU: 4243 MiB)
Epoch 2 - update       2460 => loss: 0.583 (used GPU: 4243 MiB)
Epoch 2 - update       2490 => loss: 0.866 (used GPU: 4243 MiB)
Epoch 2 - update       2520 => loss: 0.797 (used GPU: 4243 MiB)
Epoch 2 - update       2550 => loss: 1.006 (used GPU: 4243 MiB)
Epoch 2 - update       2580 => loss: 1.118 (used GPU: 4243 MiB)
Epoch 2 - update       2610 => loss: 0.669 (used GPU: 4243 MiB)
Epoch 2 - update       2640 => loss: 0.395 (used GPU: 4243 MiB)
Epoch 2 - update       2670 => loss: 0.885 (used GPU: 4243 MiB)
Epoch 2 - update       2700 => loss: 0.689 (used GPU: 4243 MiB)
Epoch 2 - update       2730 => loss: 0.229 (used GPU: 4243 MiB)
Epoch 2 - update       2760 => loss: 0.507 (used GPU: 4391 MiB)
Epoch 2 - update       2790 => loss: 0.860 (used GPU: 4391 MiB)
Epoch 2 - update       2820 => loss: 0.350 (used GPU: 4391 MiB)
Epoch 2 - update       2850 => loss: 0.637 (used GPU: 4391 MiB)
Epoch 2 - update       2880 => loss: 0.697 (used GPU: 4391 MiB)
Epoch 2 - update       2910 => loss: 0.952 (used GPU: 4391 MiB)
Epoch 2 - update       2940 => loss: 1.053 (used GPU: 4391 MiB)
Epoch 2 - update       2970 => loss: 0.838 (used GPU: 4391 MiB)
Epoch 2 - update       3000 => loss: 0.327 (used GPU: 4391 MiB)
Epoch 2 - update       3030 => loss: 0.282 (used GPU: 4391 MiB)
Epoch 2 - update       3060 => loss: 0.518 (used GPU: 4391 MiB)
Epoch 2 - update       3090 => loss: 0.443 (used GPU: 4391 MiB)
Epoch 2 - update       3120 => loss: 0.386 (used GPU: 4391 MiB)
Epoch 2 - update       3150 => loss: 0.788 (used GPU: 4391 MiB)
Epoch 2 - update       3180 => loss: 0.460 (used GPU: 4391 MiB)
Epoch 2 - update       3210 => loss: 0.568 (used GPU: 4391 MiB)
Epoch 2 - update       3240 => loss: 0.651 (used GPU: 4391 MiB)
Epoch 2 - update       3270 => loss: 0.652 (used GPU: 4391 MiB)
Epoch 2 - update       3300 => loss: 0.836 (used GPU: 4391 MiB)
Epoch 2 - update       3330 => loss: 0.589 (used GPU: 4391 MiB)
Epoch 2 - update       3360 => loss: 0.678 (used GPU: 4391 MiB)
Epoch 2 - update       3390 => loss: 0.833 (used GPU: 4391 MiB)
Epoch 2 - update       3420 => loss: 0.611 (used GPU: 4391 MiB)
Epoch 2 - update       3450 => loss: 0.680 (used GPU: 4391 MiB)
Epoch 2 - update       3480 => loss: 0.362 (used GPU: 4391 MiB)
Epoch 2 - update       3510 => loss: 0.783 (used GPU: 4391 MiB)
Epoch 2 - update       3540 => loss: 0.746 (used GPU: 4391 MiB)
Epoch 2 - update       3570 => loss: 0.588 (used GPU: 4391 MiB)
Epoch 2 - update       3600 => loss: 0.351 (used GPU: 4391 MiB)
Epoch 2 - update       3630 => loss: 1.033 (used GPU: 4391 MiB)
Epoch 2 - update       3660 => loss: 1.144 (used GPU: 4391 MiB)
Epoch 2 - update       3690 => loss: 0.573 (used GPU: 4391 MiB)
Epoch 2 - update       3720 => loss: 0.324 (used GPU: 4391 MiB)
Epoch 2 - update       3750 => loss: 1.102 (used GPU: 4391 MiB)
Epoch 2 - update       3780 => loss: 0.752 (used GPU: 4391 MiB)
Epoch 2 - update       3810 => loss: 0.237 (used GPU: 4391 MiB)
Epoch 2 - update       3840 => loss: 0.573 (used GPU: 4391 MiB)
Epoch 2 - update       3870 => loss: 0.785 (used GPU: 4391 MiB)
Epoch 2 - update       3900 => loss: 0.404 (used GPU: 4391 MiB)
Epoch 2 - update       3930 => loss: 0.948 (used GPU: 4391 MiB)
Epoch 2 - update       3960 => loss: 0.674 (used GPU: 4391 MiB)
--> Epoch 2 finished with mean loss 0.77719
--> Overhead/Training/Evaluation: 0.13/2.80/0.00 mins (total: 2.93 mins)   (1102 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.98 sec, Scoring: 0.38 sec (337 sent/sec)
Validation 2 -> LOSS = 1.14
Validation 2 -> MRR = 83.98
Validation 2 -> BLEU = 52.72, 76.5/58.9/46.5/36.9 (BP=1.000, ratio=1.008, hyp_len=34153, ref_len=33879)
Early stopping patience: 9
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.13 @ validation 1
--> Best MRR so far: 84.09 @ validation 1
--> Best BLEU so far: 52.91 @ validation 1
Starting Epoch 3
Epoch 3 - update       3990 => loss: 0.807 (used GPU: 4391 MiB)
Epoch 3 - update       4020 => loss: 0.851 (used GPU: 4391 MiB)
Epoch 3 - update       4050 => loss: 1.013 (used GPU: 4391 MiB)
Epoch 3 - update       4080 => loss: 0.534 (used GPU: 4391 MiB)
Epoch 3 - update       4110 => loss: 0.359 (used GPU: 4391 MiB)
Epoch 3 - update       4140 => loss: 0.860 (used GPU: 4391 MiB)
Epoch 3 - update       4170 => loss: 0.726 (used GPU: 4391 MiB)
Epoch 3 - update       4200 => loss: 0.513 (used GPU: 4391 MiB)
Epoch 3 - update       4230 => loss: 0.385 (used GPU: 4391 MiB)
Epoch 3 - update       4260 => loss: 0.756 (used GPU: 4391 MiB)
Epoch 3 - update       4290 => loss: 0.729 (used GPU: 4391 MiB)
Epoch 3 - update       4320 => loss: 0.876 (used GPU: 4391 MiB)
Epoch 3 - update       4350 => loss: 0.816 (used GPU: 4391 MiB)
Epoch 3 - update       4380 => loss: 0.822 (used GPU: 4391 MiB)
Epoch 3 - update       4410 => loss: 0.792 (used GPU: 4391 MiB)
Epoch 3 - update       4440 => loss: 0.483 (used GPU: 4391 MiB)
Epoch 3 - update       4470 => loss: 0.288 (used GPU: 4391 MiB)
Epoch 3 - update       4500 => loss: 0.558 (used GPU: 4391 MiB)
Epoch 3 - update       4530 => loss: 0.565 (used GPU: 4391 MiB)
Epoch 3 - update       4560 => loss: 0.846 (used GPU: 4391 MiB)
Epoch 3 - update       4590 => loss: 0.745 (used GPU: 4391 MiB)
Epoch 3 - update       4620 => loss: 0.831 (used GPU: 4391 MiB)
Epoch 3 - update       4650 => loss: 0.251 (used GPU: 4391 MiB)
Epoch 3 - update       4680 => loss: 0.796 (used GPU: 4391 MiB)
Epoch 3 - update       4710 => loss: 0.523 (used GPU: 4391 MiB)
Epoch 3 - update       4740 => loss: 0.470 (used GPU: 4391 MiB)
Epoch 3 - update       4770 => loss: 0.446 (used GPU: 4391 MiB)
Epoch 3 - update       4800 => loss: 1.203 (used GPU: 4391 MiB)
Epoch 3 - update       4830 => loss: 0.475 (used GPU: 4391 MiB)
Epoch 3 - update       4860 => loss: 0.457 (used GPU: 4391 MiB)
Epoch 3 - update       4890 => loss: 0.368 (used GPU: 4391 MiB)
Epoch 3 - update       4920 => loss: 0.352 (used GPU: 4391 MiB)
Epoch 3 - update       4950 => loss: 0.292 (used GPU: 4391 MiB)
Epoch 3 - update       4980 => loss: 0.648 (used GPU: 4391 MiB)
Epoch 3 - update       5010 => loss: 0.935 (used GPU: 4391 MiB)
Epoch 3 - update       5040 => loss: 0.421 (used GPU: 4391 MiB)
Epoch 3 - update       5070 => loss: 0.756 (used GPU: 4391 MiB)
Epoch 3 - update       5100 => loss: 1.060 (used GPU: 4391 MiB)
Epoch 3 - update       5130 => loss: 0.372 (used GPU: 4391 MiB)
Epoch 3 - update       5160 => loss: 0.448 (used GPU: 4391 MiB)
Epoch 3 - update       5190 => loss: 0.833 (used GPU: 4391 MiB)
Epoch 3 - update       5220 => loss: 1.090 (used GPU: 4391 MiB)
Epoch 3 - update       5250 => loss: 0.489 (used GPU: 4391 MiB)
Epoch 3 - update       5280 => loss: 0.531 (used GPU: 4391 MiB)
Epoch 3 - update       5310 => loss: 0.645 (used GPU: 4391 MiB)
Epoch 3 - update       5340 => loss: 0.579 (used GPU: 4391 MiB)
Epoch 3 - update       5370 => loss: 1.019 (used GPU: 4391 MiB)
Epoch 3 - update       5400 => loss: 0.671 (used GPU: 4391 MiB)
Epoch 3 - update       5430 => loss: 0.747 (used GPU: 4391 MiB)
Epoch 3 - update       5460 => loss: 0.630 (used GPU: 4391 MiB)
Epoch 3 - update       5490 => loss: 0.271 (used GPU: 4391 MiB)
Epoch 3 - update       5520 => loss: 0.359 (used GPU: 4391 MiB)
Epoch 3 - update       5550 => loss: 1.081 (used GPU: 4391 MiB)
Epoch 3 - update       5580 => loss: 0.868 (used GPU: 4391 MiB)
Epoch 3 - update       5610 => loss: 0.292 (used GPU: 4391 MiB)
Epoch 3 - update       5640 => loss: 0.868 (used GPU: 4391 MiB)
Epoch 3 - update       5670 => loss: 0.636 (used GPU: 4391 MiB)
Epoch 3 - update       5700 => loss: 0.657 (used GPU: 4391 MiB)
Epoch 3 - update       5730 => loss: 0.351 (used GPU: 4391 MiB)
Epoch 3 - update       5760 => loss: 0.571 (used GPU: 4391 MiB)
Epoch 3 - update       5790 => loss: 0.390 (used GPU: 4391 MiB)
Epoch 3 - update       5820 => loss: 0.290 (used GPU: 4391 MiB)
Epoch 3 - update       5850 => loss: 0.730 (used GPU: 4391 MiB)
Epoch 3 - update       5880 => loss: 0.531 (used GPU: 4391 MiB)
Epoch 3 - update       5910 => loss: 0.383 (used GPU: 4391 MiB)
Epoch 3 - update       5940 => loss: 0.421 (used GPU: 4391 MiB)
Epoch 3 - update       5970 => loss: 0.738 (used GPU: 4391 MiB)
--> Epoch 3 finished with mean loss 0.77553
--> Overhead/Training/Evaluation: 0.14/2.81/0.00 mins (total: 2.94 mins)   (1099 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.91 sec, Scoring: 0.38 sec (342 sent/sec)
Validation 3 -> LOSS = 1.13
Validation 3 -> MRR = 84.04
Validation 3 -> BLEU = 52.97, 76.6/59.0/46.8/37.3 (BP=1.000, ratio=1.003, hyp_len=33967, ref_len=33879)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.13 @ validation 1
--> Best MRR so far: 84.09 @ validation 1
--> Best BLEU so far: 52.97 @ validation 3
Starting Epoch 4
Epoch 4 - update       6000 => loss: 0.795 (used GPU: 4391 MiB)
Epoch 4 - update       6030 => loss: 0.557 (used GPU: 4391 MiB)
Epoch 4 - update       6060 => loss: 0.690 (used GPU: 4391 MiB)
Epoch 4 - update       6090 => loss: 0.784 (used GPU: 4391 MiB)
Epoch 4 - update       6120 => loss: 0.234 (used GPU: 4391 MiB)
Epoch 4 - update       6150 => loss: 0.411 (used GPU: 4391 MiB)
Epoch 4 - update       6180 => loss: 0.593 (used GPU: 4391 MiB)
Epoch 4 - update       6210 => loss: 0.360 (used GPU: 4391 MiB)
Epoch 4 - update       6240 => loss: 0.289 (used GPU: 4391 MiB)
Epoch 4 - update       6270 => loss: 0.492 (used GPU: 4391 MiB)
Epoch 4 - update       6300 => loss: 0.492 (used GPU: 4391 MiB)
Epoch 4 - update       6330 => loss: 0.806 (used GPU: 4391 MiB)
Epoch 4 - update       6360 => loss: 0.506 (used GPU: 4391 MiB)
Epoch 4 - update       6390 => loss: 0.613 (used GPU: 4391 MiB)
Epoch 4 - update       6420 => loss: 0.599 (used GPU: 4391 MiB)
Epoch 4 - update       6450 => loss: 0.819 (used GPU: 4391 MiB)
Epoch 4 - update       6480 => loss: 0.301 (used GPU: 4391 MiB)
Epoch 4 - update       6510 => loss: 0.872 (used GPU: 4391 MiB)
Epoch 4 - update       6540 => loss: 0.974 (used GPU: 4391 MiB)
Epoch 4 - update       6570 => loss: 0.875 (used GPU: 4391 MiB)
Epoch 4 - update       6600 => loss: 0.543 (used GPU: 4391 MiB)
Epoch 4 - update       6630 => loss: 0.645 (used GPU: 4391 MiB)
Epoch 4 - update       6660 => loss: 0.329 (used GPU: 4391 MiB)
Epoch 4 - update       6690 => loss: 0.801 (used GPU: 4391 MiB)
Epoch 4 - update       6720 => loss: 0.333 (used GPU: 4391 MiB)
Epoch 4 - update       6750 => loss: 0.196 (used GPU: 4391 MiB)
Epoch 4 - update       6780 => loss: 0.515 (used GPU: 4391 MiB)
Epoch 4 - update       6810 => loss: 0.911 (used GPU: 4391 MiB)
Epoch 4 - update       6840 => loss: 0.552 (used GPU: 4391 MiB)
Epoch 4 - update       6870 => loss: 0.425 (used GPU: 4391 MiB)
Epoch 4 - update       6900 => loss: 1.080 (used GPU: 4391 MiB)
Epoch 4 - update       6930 => loss: 0.495 (used GPU: 4391 MiB)
Epoch 4 - update       6960 => loss: 0.464 (used GPU: 4391 MiB)
Epoch 4 - update       6990 => loss: 0.923 (used GPU: 4391 MiB)
Epoch 4 - update       7020 => loss: 0.821 (used GPU: 4391 MiB)
Epoch 4 - update       7050 => loss: 0.636 (used GPU: 4391 MiB)
Epoch 4 - update       7080 => loss: 0.769 (used GPU: 4391 MiB)
Epoch 4 - update       7110 => loss: 0.557 (used GPU: 4391 MiB)
Epoch 4 - update       7140 => loss: 0.865 (used GPU: 4391 MiB)
Epoch 4 - update       7170 => loss: 0.391 (used GPU: 4391 MiB)
Epoch 4 - update       7200 => loss: 0.570 (used GPU: 4391 MiB)
Epoch 4 - update       7230 => loss: 0.479 (used GPU: 4391 MiB)
Epoch 4 - update       7260 => loss: 0.355 (used GPU: 4391 MiB)
Epoch 4 - update       7290 => loss: 0.667 (used GPU: 4391 MiB)
Epoch 4 - update       7320 => loss: 0.384 (used GPU: 4391 MiB)
Epoch 4 - update       7350 => loss: 0.663 (used GPU: 4391 MiB)
Epoch 4 - update       7380 => loss: 0.495 (used GPU: 4391 MiB)
Epoch 4 - update       7410 => loss: 0.802 (used GPU: 4391 MiB)
Epoch 4 - update       7440 => loss: 0.716 (used GPU: 4391 MiB)
Epoch 4 - update       7470 => loss: 0.650 (used GPU: 4391 MiB)
Epoch 4 - update       7500 => loss: 0.419 (used GPU: 4391 MiB)
Epoch 4 - update       7530 => loss: 0.289 (used GPU: 4391 MiB)
Epoch 4 - update       7560 => loss: 0.425 (used GPU: 4391 MiB)
Epoch 4 - update       7590 => loss: 0.938 (used GPU: 4391 MiB)
Epoch 4 - update       7620 => loss: 0.672 (used GPU: 4391 MiB)
Epoch 4 - update       7650 => loss: 0.824 (used GPU: 4391 MiB)
Epoch 4 - update       7680 => loss: 0.408 (used GPU: 4391 MiB)
Epoch 4 - update       7710 => loss: 0.626 (used GPU: 4391 MiB)
Epoch 4 - update       7740 => loss: 1.039 (used GPU: 4391 MiB)
Epoch 4 - update       7770 => loss: 1.300 (used GPU: 4391 MiB)
Epoch 4 - update       7800 => loss: 0.821 (used GPU: 4391 MiB)
Epoch 4 - update       7830 => loss: 0.794 (used GPU: 4391 MiB)
Epoch 4 - update       7860 => loss: 0.483 (used GPU: 4391 MiB)
Epoch 4 - update       7890 => loss: 0.335 (used GPU: 4391 MiB)
Epoch 4 - update       7920 => loss: 1.166 (used GPU: 4391 MiB)
Epoch 4 - update       7950 => loss: 0.923 (used GPU: 4391 MiB)
--> Epoch 4 finished with mean loss 0.77244
--> Overhead/Training/Evaluation: 0.16/2.81/0.00 mins (total: 2.96 mins)   (1099 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.87 sec, Scoring: 0.38 sec (344 sent/sec)
Validation 4 -> LOSS = 1.13
Validation 4 -> MRR = 84.05
Validation 4 -> BLEU = 52.93, 76.4/59.0/46.7/37.3 (BP=1.000, ratio=1.007, hyp_len=34106, ref_len=33879)
Early stopping patience: 9
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.13 @ validation 1
--> Best MRR so far: 84.09 @ validation 1
--> Best BLEU so far: 52.97 @ validation 3
Starting Epoch 5
Epoch 5 - update       7980 => loss: 0.624 (used GPU: 4391 MiB)
Epoch 5 - update       8010 => loss: 0.261 (used GPU: 4391 MiB)
Epoch 5 - update       8040 => loss: 0.375 (used GPU: 4391 MiB)
Epoch 5 - update       8070 => loss: 0.664 (used GPU: 4391 MiB)
Epoch 5 - update       8100 => loss: 0.941 (used GPU: 4391 MiB)
Epoch 5 - update       8130 => loss: 0.633 (used GPU: 4391 MiB)
Epoch 5 - update       8160 => loss: 0.445 (used GPU: 4391 MiB)
Epoch 5 - update       8190 => loss: 0.392 (used GPU: 4391 MiB)
Epoch 5 - update       8220 => loss: 0.256 (used GPU: 4391 MiB)
Epoch 5 - update       8250 => loss: 0.551 (used GPU: 4391 MiB)
Epoch 5 - update       8280 => loss: 0.611 (used GPU: 4391 MiB)
Epoch 5 - update       8310 => loss: 0.393 (used GPU: 4391 MiB)
Epoch 5 - update       8340 => loss: 0.356 (used GPU: 4391 MiB)
Epoch 5 - update       8370 => loss: 0.628 (used GPU: 4391 MiB)
Epoch 5 - update       8400 => loss: 0.863 (used GPU: 4391 MiB)
Epoch 5 - update       8430 => loss: 0.600 (used GPU: 4391 MiB)
Epoch 5 - update       8460 => loss: 0.549 (used GPU: 4391 MiB)
Epoch 5 - update       8490 => loss: 1.016 (used GPU: 4391 MiB)
Epoch 5 - update       8520 => loss: 0.437 (used GPU: 4391 MiB)
Epoch 5 - update       8550 => loss: 0.891 (used GPU: 4391 MiB)
Epoch 5 - update       8580 => loss: 0.497 (used GPU: 4391 MiB)
Epoch 5 - update       8610 => loss: 0.501 (used GPU: 4391 MiB)
Epoch 5 - update       8640 => loss: 0.898 (used GPU: 4391 MiB)
Epoch 5 - update       8670 => loss: 0.648 (used GPU: 4391 MiB)
Epoch 5 - update       8700 => loss: 0.730 (used GPU: 4391 MiB)
Epoch 5 - update       8730 => loss: 0.900 (used GPU: 4391 MiB)
Epoch 5 - update       8760 => loss: 0.665 (used GPU: 4391 MiB)
Epoch 5 - update       8790 => loss: 0.716 (used GPU: 4391 MiB)
Epoch 5 - update       8820 => loss: 0.711 (used GPU: 4391 MiB)
Epoch 5 - update       8850 => loss: 0.797 (used GPU: 4391 MiB)
Epoch 5 - update       8880 => loss: 0.212 (used GPU: 4391 MiB)
Epoch 5 - update       8910 => loss: 0.975 (used GPU: 4391 MiB)
Epoch 5 - update       8940 => loss: 0.602 (used GPU: 4391 MiB)
Epoch 5 - update       8970 => loss: 0.407 (used GPU: 4391 MiB)
Epoch 5 - update       9000 => loss: 0.596 (used GPU: 4391 MiB)
Epoch 5 - update       9030 => loss: 0.814 (used GPU: 4391 MiB)
Epoch 5 - update       9060 => loss: 0.326 (used GPU: 4391 MiB)
Epoch 5 - update       9090 => loss: 0.639 (used GPU: 4391 MiB)
Epoch 5 - update       9120 => loss: 0.582 (used GPU: 4391 MiB)
Epoch 5 - update       9150 => loss: 0.786 (used GPU: 4391 MiB)
Epoch 5 - update       9180 => loss: 0.580 (used GPU: 4391 MiB)
Epoch 5 - update       9210 => loss: 0.742 (used GPU: 4391 MiB)
Epoch 5 - update       9240 => loss: 0.704 (used GPU: 4391 MiB)
Epoch 5 - update       9270 => loss: 1.063 (used GPU: 4391 MiB)
Epoch 5 - update       9300 => loss: 0.776 (used GPU: 4391 MiB)
Epoch 5 - update       9330 => loss: 0.380 (used GPU: 4391 MiB)
Epoch 5 - update       9360 => loss: 0.363 (used GPU: 4391 MiB)
Epoch 5 - update       9390 => loss: 1.165 (used GPU: 4391 MiB)
Epoch 5 - update       9420 => loss: 0.418 (used GPU: 4391 MiB)
Epoch 5 - update       9450 => loss: 0.256 (used GPU: 4391 MiB)
Epoch 5 - update       9480 => loss: 0.551 (used GPU: 4391 MiB)
Epoch 5 - update       9510 => loss: 0.401 (used GPU: 4391 MiB)
Epoch 5 - update       9540 => loss: 0.738 (used GPU: 4391 MiB)
Epoch 5 - update       9570 => loss: 1.122 (used GPU: 4391 MiB)
Epoch 5 - update       9600 => loss: 1.015 (used GPU: 4391 MiB)
Epoch 5 - update       9630 => loss: 0.399 (used GPU: 4391 MiB)
Epoch 5 - update       9660 => loss: 0.360 (used GPU: 4391 MiB)
Epoch 5 - update       9690 => loss: 0.679 (used GPU: 4391 MiB)
Epoch 5 - update       9720 => loss: 0.566 (used GPU: 4391 MiB)
Epoch 5 - update       9750 => loss: 0.945 (used GPU: 4391 MiB)
Epoch 5 - update       9780 => loss: 0.796 (used GPU: 4391 MiB)
Epoch 5 - update       9810 => loss: 0.338 (used GPU: 4391 MiB)
Epoch 5 - update       9840 => loss: 0.579 (used GPU: 4391 MiB)
Epoch 5 - update       9870 => loss: 0.570 (used GPU: 4391 MiB)
Epoch 5 - update       9900 => loss: 0.652 (used GPU: 4391 MiB)
Epoch 5 - update       9930 => loss: 0.680 (used GPU: 4391 MiB)
--> Epoch 5 finished with mean loss 0.76802
--> Overhead/Training/Evaluation: 0.13/2.80/0.00 mins (total: 2.94 mins)   (1102 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.90 sec, Scoring: 0.38 sec (342 sent/sec)
Validation 5 -> LOSS = 1.13
Validation 5 -> MRR = 84.16
Validation 5 -> BLEU = 52.96, 76.6/59.1/46.7/37.1 (BP=1.000, ratio=1.009, hyp_len=34197, ref_len=33879)
Early stopping patience: 8
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.13 @ validation 1
--> Best MRR so far: 84.16 @ validation 5
--> Best BLEU so far: 52.97 @ validation 3
Starting Epoch 6
Epoch 6 - update       9960 => loss: 0.298 (used GPU: 4391 MiB)
Epoch 6 - update       9990 => loss: 0.593 (used GPU: 4391 MiB)
Epoch 6 - update      10020 => loss: 0.725 (used GPU: 4391 MiB)
Epoch 6 - update      10050 => loss: 0.904 (used GPU: 4391 MiB)
Epoch 6 - update      10080 => loss: 0.680 (used GPU: 4391 MiB)
Epoch 6 - update      10110 => loss: 0.719 (used GPU: 4391 MiB)
Epoch 6 - update      10140 => loss: 0.734 (used GPU: 4391 MiB)
Epoch 6 - update      10170 => loss: 0.320 (used GPU: 4391 MiB)
Epoch 6 - update      10200 => loss: 0.556 (used GPU: 4391 MiB)
Epoch 6 - update      10230 => loss: 0.858 (used GPU: 4391 MiB)
Epoch 6 - update      10260 => loss: 0.255 (used GPU: 4391 MiB)
Epoch 6 - update      10290 => loss: 0.883 (used GPU: 4391 MiB)
Epoch 6 - update      10320 => loss: 1.022 (used GPU: 4391 MiB)
Epoch 6 - update      10350 => loss: 0.241 (used GPU: 4391 MiB)
Epoch 6 - update      10380 => loss: 0.704 (used GPU: 4391 MiB)
Epoch 6 - update      10410 => loss: 0.637 (used GPU: 4391 MiB)
Epoch 6 - update      10440 => loss: 1.100 (used GPU: 4391 MiB)
Epoch 6 - update      10470 => loss: 0.280 (used GPU: 4391 MiB)
Epoch 6 - update      10500 => loss: 0.961 (used GPU: 4391 MiB)
Epoch 6 - update      10530 => loss: 0.687 (used GPU: 4391 MiB)
Epoch 6 - update      10560 => loss: 0.341 (used GPU: 4391 MiB)
Epoch 6 - update      10590 => loss: 0.993 (used GPU: 4391 MiB)
Epoch 6 - update      10620 => loss: 0.339 (used GPU: 4391 MiB)
Epoch 6 - update      10650 => loss: 0.362 (used GPU: 4391 MiB)
Epoch 6 - update      10680 => loss: 0.367 (used GPU: 4391 MiB)
Epoch 6 - update      10710 => loss: 0.282 (used GPU: 4391 MiB)
Epoch 6 - update      10740 => loss: 0.350 (used GPU: 4391 MiB)
Epoch 6 - update      10770 => loss: 1.160 (used GPU: 4391 MiB)
Epoch 6 - update      10800 => loss: 0.825 (used GPU: 4391 MiB)
Epoch 6 - update      10830 => loss: 0.628 (used GPU: 4391 MiB)
Epoch 6 - update      10860 => loss: 0.323 (used GPU: 4391 MiB)
Epoch 6 - update      10890 => loss: 0.607 (used GPU: 4391 MiB)
Epoch 6 - update      10920 => loss: 0.743 (used GPU: 4391 MiB)
Epoch 6 - update      10950 => loss: 1.008 (used GPU: 4391 MiB)
Epoch 6 - update      10980 => loss: 0.431 (used GPU: 4391 MiB)
Epoch 6 - update      11010 => loss: 0.342 (used GPU: 4391 MiB)
Epoch 6 - update      11040 => loss: 0.861 (used GPU: 4391 MiB)
Epoch 6 - update      11070 => loss: 0.555 (used GPU: 4391 MiB)
Epoch 6 - update      11100 => loss: 1.113 (used GPU: 4391 MiB)
Epoch 6 - update      11130 => loss: 0.585 (used GPU: 4391 MiB)
Epoch 6 - update      11160 => loss: 0.337 (used GPU: 4391 MiB)
Epoch 6 - update      11190 => loss: 0.770 (used GPU: 4391 MiB)
Epoch 6 - update      11220 => loss: 0.797 (used GPU: 4391 MiB)
Epoch 6 - update      11250 => loss: 0.322 (used GPU: 4391 MiB)
Epoch 6 - update      11280 => loss: 0.377 (used GPU: 4391 MiB)
Epoch 6 - update      11310 => loss: 0.556 (used GPU: 4391 MiB)
Epoch 6 - update      11340 => loss: 1.061 (used GPU: 4391 MiB)
Epoch 6 - update      11370 => loss: 0.435 (used GPU: 4391 MiB)
Epoch 6 - update      11400 => loss: 0.472 (used GPU: 4391 MiB)
Epoch 6 - update      11430 => loss: 0.293 (used GPU: 4391 MiB)
Epoch 6 - update      11460 => loss: 0.508 (used GPU: 4391 MiB)
Epoch 6 - update      11490 => loss: 0.613 (used GPU: 4391 MiB)
Epoch 6 - update      11520 => loss: 0.609 (used GPU: 4391 MiB)
Epoch 6 - update      11550 => loss: 0.467 (used GPU: 4391 MiB)
Epoch 6 - update      11580 => loss: 0.551 (used GPU: 4391 MiB)
Epoch 6 - update      11610 => loss: 1.136 (used GPU: 4391 MiB)
Epoch 6 - update      11640 => loss: 0.871 (used GPU: 4391 MiB)
Epoch 6 - update      11670 => loss: 0.718 (used GPU: 4391 MiB)
Epoch 6 - update      11700 => loss: 0.563 (used GPU: 4391 MiB)
Epoch 6 - update      11730 => loss: 0.644 (used GPU: 4391 MiB)
Epoch 6 - update      11760 => loss: 0.373 (used GPU: 4391 MiB)
Epoch 6 - update      11790 => loss: 0.686 (used GPU: 4391 MiB)
Epoch 6 - update      11820 => loss: 0.814 (used GPU: 4391 MiB)
Epoch 6 - update      11850 => loss: 0.883 (used GPU: 4391 MiB)
Epoch 6 - update      11880 => loss: 0.699 (used GPU: 4391 MiB)
Epoch 6 - update      11910 => loss: 0.914 (used GPU: 4391 MiB)
Epoch 6 - update      11940 => loss: 0.861 (used GPU: 4391 MiB)
--> Epoch 6 finished with mean loss 0.76416
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.94 mins)   (1101 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.94 sec, Scoring: 0.40 sec (340 sent/sec)
Validation 6 -> LOSS = 1.13
Validation 6 -> MRR = 84.13
Validation 6 -> BLEU = 53.14, 76.6/59.2/46.9/37.5 (BP=1.000, ratio=1.008, hyp_len=34157, ref_len=33879)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.13 @ validation 1
--> Best MRR so far: 84.16 @ validation 5
--> Best BLEU so far: 53.14 @ validation 6
Starting Epoch 7
Epoch 7 - update      11970 => loss: 0.844 (used GPU: 4391 MiB)
Epoch 7 - update      12000 => loss: 0.524 (used GPU: 4391 MiB)
Epoch 7 - update      12030 => loss: 0.300 (used GPU: 4391 MiB)
Epoch 7 - update      12060 => loss: 0.914 (used GPU: 4391 MiB)
Epoch 7 - update      12090 => loss: 0.727 (used GPU: 4391 MiB)
Epoch 7 - update      12120 => loss: 0.791 (used GPU: 4391 MiB)
Epoch 7 - update      12150 => loss: 0.297 (used GPU: 4391 MiB)
Epoch 7 - update      12180 => loss: 0.711 (used GPU: 4391 MiB)
Epoch 7 - update      12210 => loss: 0.930 (used GPU: 4391 MiB)
Epoch 7 - update      12240 => loss: 0.964 (used GPU: 4391 MiB)
Epoch 7 - update      12270 => loss: 0.410 (used GPU: 4391 MiB)
Epoch 7 - update      12300 => loss: 0.579 (used GPU: 4391 MiB)
Epoch 7 - update      12330 => loss: 0.266 (used GPU: 4391 MiB)
Epoch 7 - update      12360 => loss: 0.421 (used GPU: 4391 MiB)
Epoch 7 - update      12390 => loss: 0.581 (used GPU: 4391 MiB)
Epoch 7 - update      12420 => loss: 0.454 (used GPU: 4391 MiB)
Epoch 7 - update      12450 => loss: 0.701 (used GPU: 4391 MiB)
Epoch 7 - update      12480 => loss: 0.846 (used GPU: 4391 MiB)
Epoch 7 - update      12510 => loss: 0.448 (used GPU: 4391 MiB)
Epoch 7 - update      12540 => loss: 0.735 (used GPU: 4391 MiB)
Epoch 7 - update      12570 => loss: 0.543 (used GPU: 4391 MiB)
Epoch 7 - update      12600 => loss: 0.552 (used GPU: 4391 MiB)
Epoch 7 - update      12630 => loss: 0.712 (used GPU: 4391 MiB)
Epoch 7 - update      12660 => loss: 1.003 (used GPU: 4391 MiB)
Epoch 7 - update      12690 => loss: 0.578 (used GPU: 4391 MiB)
Epoch 7 - update      12720 => loss: 0.453 (used GPU: 4391 MiB)
Epoch 7 - update      12750 => loss: 0.254 (used GPU: 4391 MiB)
Epoch 7 - update      12780 => loss: 0.978 (used GPU: 4391 MiB)
Epoch 7 - update      12810 => loss: 0.316 (used GPU: 4391 MiB)
Epoch 7 - update      12840 => loss: 0.724 (used GPU: 4391 MiB)
Epoch 7 - update      12870 => loss: 0.415 (used GPU: 4391 MiB)
Epoch 7 - update      12900 => loss: 0.603 (used GPU: 4391 MiB)
Epoch 7 - update      12930 => loss: 0.866 (used GPU: 4391 MiB)
Epoch 7 - update      12960 => loss: 0.458 (used GPU: 4391 MiB)
Epoch 7 - update      12990 => loss: 0.682 (used GPU: 4391 MiB)
Epoch 7 - update      13020 => loss: 0.881 (used GPU: 4391 MiB)
Epoch 7 - update      13050 => loss: 1.135 (used GPU: 4391 MiB)
Epoch 7 - update      13080 => loss: 0.374 (used GPU: 4391 MiB)
Epoch 7 - update      13110 => loss: 0.637 (used GPU: 4391 MiB)
Epoch 7 - update      13140 => loss: 0.617 (used GPU: 4391 MiB)
Epoch 7 - update      13170 => loss: 0.460 (used GPU: 4391 MiB)
Epoch 7 - update      13200 => loss: 0.523 (used GPU: 4391 MiB)
Epoch 7 - update      13230 => loss: 0.630 (used GPU: 4391 MiB)
Epoch 7 - update      13260 => loss: 0.256 (used GPU: 4391 MiB)
Epoch 7 - update      13290 => loss: 0.696 (used GPU: 4391 MiB)
Epoch 7 - update      13320 => loss: 0.917 (used GPU: 4391 MiB)
Epoch 7 - update      13350 => loss: 0.745 (used GPU: 4391 MiB)
Epoch 7 - update      13380 => loss: 0.475 (used GPU: 4391 MiB)
Epoch 7 - update      13410 => loss: 0.627 (used GPU: 4391 MiB)
Epoch 7 - update      13440 => loss: 0.738 (used GPU: 4391 MiB)
Epoch 7 - update      13470 => loss: 0.311 (used GPU: 4391 MiB)
Epoch 7 - update      13500 => loss: 0.644 (used GPU: 4391 MiB)
Epoch 7 - update      13530 => loss: 1.224 (used GPU: 4391 MiB)
Epoch 7 - update      13560 => loss: 0.686 (used GPU: 4391 MiB)
Epoch 7 - update      13590 => loss: 0.394 (used GPU: 4391 MiB)
Epoch 7 - update      13620 => loss: 0.821 (used GPU: 4391 MiB)
Epoch 7 - update      13650 => loss: 0.911 (used GPU: 4391 MiB)
Epoch 7 - update      13680 => loss: 0.802 (used GPU: 4391 MiB)
Epoch 7 - update      13710 => loss: 0.479 (used GPU: 4391 MiB)
Epoch 7 - update      13740 => loss: 0.872 (used GPU: 4391 MiB)
Epoch 7 - update      13770 => loss: 0.722 (used GPU: 4391 MiB)
Epoch 7 - update      13800 => loss: 0.938 (used GPU: 4391 MiB)
Epoch 7 - update      13830 => loss: 0.260 (used GPU: 4391 MiB)
Epoch 7 - update      13860 => loss: 0.302 (used GPU: 4391 MiB)
Epoch 7 - update      13890 => loss: 0.863 (used GPU: 4391 MiB)
Epoch 7 - update      13920 => loss: 0.335 (used GPU: 4391 MiB)
--> Epoch 7 finished with mean loss 0.75877
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.93 mins)   (1102 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.91 sec, Scoring: 0.38 sec (342 sent/sec)
Validation 7 -> LOSS = 1.13
Validation 7 -> MRR = 84.17
Validation 7 -> BLEU = 53.17, 76.8/59.3/46.9/37.4 (BP=1.000, ratio=1.008, hyp_len=34143, ref_len=33879)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.13 @ validation 1
--> Best MRR so far: 84.17 @ validation 7
--> Best BLEU so far: 53.17 @ validation 7
Starting Epoch 8
Epoch 8 - update      13950 => loss: 0.406 (used GPU: 4391 MiB)
Epoch 8 - update      13980 => loss: 0.774 (used GPU: 4391 MiB)
Epoch 8 - update      14010 => loss: 0.465 (used GPU: 4391 MiB)
Epoch 8 - update      14040 => loss: 0.432 (used GPU: 4391 MiB)
Epoch 8 - update      14070 => loss: 0.326 (used GPU: 4391 MiB)
Epoch 8 - update      14100 => loss: 0.636 (used GPU: 4391 MiB)
Epoch 8 - update      14130 => loss: 0.439 (used GPU: 4391 MiB)
Epoch 8 - update      14160 => loss: 0.843 (used GPU: 4391 MiB)
Epoch 8 - update      14190 => loss: 0.889 (used GPU: 4391 MiB)
Epoch 8 - update      14220 => loss: 0.527 (used GPU: 4391 MiB)
Epoch 8 - update      14250 => loss: 0.571 (used GPU: 4391 MiB)
Epoch 8 - update      14280 => loss: 0.580 (used GPU: 4391 MiB)
Epoch 8 - update      14310 => loss: 0.535 (used GPU: 4391 MiB)
Epoch 8 - update      14340 => loss: 0.304 (used GPU: 4391 MiB)
Epoch 8 - update      14370 => loss: 0.284 (used GPU: 4391 MiB)
Epoch 8 - update      14400 => loss: 0.909 (used GPU: 4391 MiB)
Epoch 8 - update      14430 => loss: 0.282 (used GPU: 4391 MiB)
Epoch 8 - update      14460 => loss: 1.000 (used GPU: 4391 MiB)
Epoch 8 - update      14490 => loss: 0.656 (used GPU: 4391 MiB)
Epoch 8 - update      14520 => loss: 1.028 (used GPU: 4391 MiB)
Epoch 8 - update      14550 => loss: 0.468 (used GPU: 4391 MiB)
Epoch 8 - update      14580 => loss: 0.548 (used GPU: 4391 MiB)
Epoch 8 - update      14610 => loss: 0.828 (used GPU: 4391 MiB)
Epoch 8 - update      14640 => loss: 0.626 (used GPU: 4391 MiB)
Epoch 8 - update      14670 => loss: 0.403 (used GPU: 4391 MiB)
Epoch 8 - update      14700 => loss: 0.621 (used GPU: 4391 MiB)
Epoch 8 - update      14730 => loss: 0.629 (used GPU: 4391 MiB)
Epoch 8 - update      14760 => loss: 0.686 (used GPU: 4391 MiB)
Epoch 8 - update      14790 => loss: 0.566 (used GPU: 4391 MiB)
Epoch 8 - update      14820 => loss: 0.475 (used GPU: 4391 MiB)
Epoch 8 - update      14850 => loss: 0.980 (used GPU: 4391 MiB)
Epoch 8 - update      14880 => loss: 0.562 (used GPU: 4391 MiB)
Epoch 8 - update      14910 => loss: 0.562 (used GPU: 4391 MiB)
Epoch 8 - update      14940 => loss: 1.006 (used GPU: 4391 MiB)
Epoch 8 - update      14970 => loss: 0.559 (used GPU: 4391 MiB)
Epoch 8 - update      15000 => loss: 0.860 (used GPU: 4391 MiB)
Epoch 8 - update      15030 => loss: 1.001 (used GPU: 4391 MiB)
Epoch 8 - update      15060 => loss: 0.509 (used GPU: 4391 MiB)
Epoch 8 - update      15090 => loss: 0.893 (used GPU: 4391 MiB)
Epoch 8 - update      15120 => loss: 0.924 (used GPU: 4391 MiB)
Epoch 8 - update      15150 => loss: 0.602 (used GPU: 4391 MiB)
Epoch 8 - update      15180 => loss: 0.601 (used GPU: 4391 MiB)
Epoch 8 - update      15210 => loss: 0.304 (used GPU: 4391 MiB)
Epoch 8 - update      15240 => loss: 0.867 (used GPU: 4391 MiB)
Epoch 8 - update      15270 => loss: 0.579 (used GPU: 4391 MiB)
Epoch 8 - update      15300 => loss: 0.556 (used GPU: 4391 MiB)
Epoch 8 - update      15330 => loss: 0.402 (used GPU: 4391 MiB)
Epoch 8 - update      15360 => loss: 0.392 (used GPU: 4391 MiB)
Epoch 8 - update      15390 => loss: 0.724 (used GPU: 4391 MiB)
Epoch 8 - update      15420 => loss: 0.923 (used GPU: 4391 MiB)
Epoch 8 - update      15450 => loss: 0.523 (used GPU: 4391 MiB)
Epoch 8 - update      15480 => loss: 0.806 (used GPU: 4391 MiB)
Epoch 8 - update      15510 => loss: 0.957 (used GPU: 4391 MiB)
Epoch 8 - update      15540 => loss: 0.689 (used GPU: 4391 MiB)
Epoch 8 - update      15570 => loss: 0.628 (used GPU: 4391 MiB)
Epoch 8 - update      15600 => loss: 0.775 (used GPU: 4391 MiB)
Epoch 8 - update      15630 => loss: 0.468 (used GPU: 4391 MiB)
Epoch 8 - update      15660 => loss: 0.366 (used GPU: 4391 MiB)
Epoch 8 - update      15690 => loss: 0.221 (used GPU: 4391 MiB)
Epoch 8 - update      15720 => loss: 0.755 (used GPU: 4391 MiB)
Epoch 8 - update      15750 => loss: 0.498 (used GPU: 4391 MiB)
Epoch 8 - update      15780 => loss: 0.908 (used GPU: 4391 MiB)
Epoch 8 - update      15810 => loss: 0.831 (used GPU: 4391 MiB)
Epoch 8 - update      15840 => loss: 0.828 (used GPU: 4391 MiB)
Epoch 8 - update      15870 => loss: 0.253 (used GPU: 4391 MiB)
Epoch 8 - update      15900 => loss: 1.221 (used GPU: 4391 MiB)
--> Epoch 8 finished with mean loss 0.75523
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.94 mins)   (1101 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.91 sec, Scoring: 0.39 sec (341 sent/sec)
Validation 8 -> LOSS = 1.13
Validation 8 -> MRR = 84.16
Validation 8 -> BLEU = 53.13, 76.8/59.2/46.9/37.4 (BP=1.000, ratio=1.008, hyp_len=34136, ref_len=33879)
Early stopping patience: 9
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.13 @ validation 1
--> Best MRR so far: 84.17 @ validation 7
--> Best BLEU so far: 53.17 @ validation 7
Starting Epoch 9
Epoch 9 - update      15930 => loss: 0.708 (used GPU: 4391 MiB)
Epoch 9 - update      15960 => loss: 0.763 (used GPU: 4391 MiB)
Epoch 9 - update      15990 => loss: 0.981 (used GPU: 4391 MiB)
Epoch 9 - update      16020 => loss: 0.381 (used GPU: 4391 MiB)
Epoch 9 - update      16050 => loss: 0.594 (used GPU: 4391 MiB)
Epoch 9 - update      16080 => loss: 1.029 (used GPU: 4391 MiB)
Epoch 9 - update      16110 => loss: 0.601 (used GPU: 4391 MiB)
Epoch 9 - update      16140 => loss: 0.572 (used GPU: 4391 MiB)
Epoch 9 - update      16170 => loss: 0.635 (used GPU: 4391 MiB)
Epoch 9 - update      16200 => loss: 0.864 (used GPU: 4391 MiB)
Epoch 9 - update      16230 => loss: 0.536 (used GPU: 4391 MiB)
Epoch 9 - update      16260 => loss: 0.505 (used GPU: 4391 MiB)
Epoch 9 - update      16290 => loss: 0.587 (used GPU: 4391 MiB)
Epoch 9 - update      16320 => loss: 0.423 (used GPU: 4391 MiB)
Epoch 9 - update      16350 => loss: 0.831 (used GPU: 4391 MiB)
Epoch 9 - update      16380 => loss: 1.098 (used GPU: 4391 MiB)
Epoch 9 - update      16410 => loss: 0.721 (used GPU: 4391 MiB)
Epoch 9 - update      16440 => loss: 0.346 (used GPU: 4391 MiB)
Epoch 9 - update      16470 => loss: 0.613 (used GPU: 4391 MiB)
Epoch 9 - update      16500 => loss: 0.764 (used GPU: 4391 MiB)
Epoch 9 - update      16530 => loss: 0.548 (used GPU: 4391 MiB)
Epoch 9 - update      16560 => loss: 0.552 (used GPU: 4391 MiB)
Epoch 9 - update      16590 => loss: 0.416 (used GPU: 4391 MiB)
Epoch 9 - update      16620 => loss: 0.880 (used GPU: 4391 MiB)
Epoch 9 - update      16650 => loss: 0.642 (used GPU: 4391 MiB)
Epoch 9 - update      16680 => loss: 0.577 (used GPU: 4391 MiB)
Epoch 9 - update      16710 => loss: 0.523 (used GPU: 4391 MiB)
Epoch 9 - update      16740 => loss: 0.371 (used GPU: 4391 MiB)
Epoch 9 - update      16770 => loss: 0.851 (used GPU: 4391 MiB)
Epoch 9 - update      16800 => loss: 0.316 (used GPU: 4391 MiB)
Epoch 9 - update      16830 => loss: 0.753 (used GPU: 4391 MiB)
Epoch 9 - update      16860 => loss: 0.268 (used GPU: 4391 MiB)
Epoch 9 - update      16890 => loss: 0.485 (used GPU: 4391 MiB)
Epoch 9 - update      16920 => loss: 0.338 (used GPU: 4391 MiB)
Epoch 9 - update      16950 => loss: 0.698 (used GPU: 4391 MiB)
Epoch 9 - update      16980 => loss: 0.551 (used GPU: 4391 MiB)
Epoch 9 - update      17010 => loss: 0.679 (used GPU: 4391 MiB)
Epoch 9 - update      17040 => loss: 0.777 (used GPU: 4391 MiB)
Epoch 9 - update      17070 => loss: 0.374 (used GPU: 4391 MiB)
Epoch 9 - update      17100 => loss: 0.328 (used GPU: 4391 MiB)
Epoch 9 - update      17130 => loss: 0.604 (used GPU: 4391 MiB)
Epoch 9 - update      17160 => loss: 0.563 (used GPU: 4391 MiB)
Epoch 9 - update      17190 => loss: 0.751 (used GPU: 4391 MiB)
Epoch 9 - update      17220 => loss: 0.536 (used GPU: 4391 MiB)
Epoch 9 - update      17250 => loss: 0.652 (used GPU: 4391 MiB)
Epoch 9 - update      17280 => loss: 0.709 (used GPU: 4391 MiB)
Epoch 9 - update      17310 => loss: 0.584 (used GPU: 4391 MiB)
Epoch 9 - update      17340 => loss: 0.437 (used GPU: 4391 MiB)
Epoch 9 - update      17370 => loss: 0.239 (used GPU: 4391 MiB)
Epoch 9 - update      17400 => loss: 0.600 (used GPU: 4391 MiB)
Epoch 9 - update      17430 => loss: 1.113 (used GPU: 4391 MiB)
Epoch 9 - update      17460 => loss: 0.751 (used GPU: 4391 MiB)
Epoch 9 - update      17490 => loss: 0.630 (used GPU: 4391 MiB)
Epoch 9 - update      17520 => loss: 0.853 (used GPU: 4391 MiB)
Epoch 9 - update      17550 => loss: 0.766 (used GPU: 4391 MiB)
Epoch 9 - update      17580 => loss: 0.705 (used GPU: 4391 MiB)
Epoch 9 - update      17610 => loss: 0.879 (used GPU: 4391 MiB)
Epoch 9 - update      17640 => loss: 0.528 (used GPU: 4391 MiB)
Epoch 9 - update      17670 => loss: 0.443 (used GPU: 4391 MiB)
Epoch 9 - update      17700 => loss: 0.560 (used GPU: 4391 MiB)
Epoch 9 - update      17730 => loss: 0.603 (used GPU: 4391 MiB)
Epoch 9 - update      17760 => loss: 0.773 (used GPU: 4391 MiB)
Epoch 9 - update      17790 => loss: 0.541 (used GPU: 4391 MiB)
Epoch 9 - update      17820 => loss: 0.494 (used GPU: 4391 MiB)
Epoch 9 - update      17850 => loss: 0.880 (used GPU: 4391 MiB)
Epoch 9 - update      17880 => loss: 1.525 (used GPU: 4391 MiB)
Epoch 9 - update      17910 => loss: 0.281 (used GPU: 4391 MiB)
--> Epoch 9 finished with mean loss 0.75040
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.94 mins)   (1101 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.88 sec, Scoring: 0.38 sec (343 sent/sec)
Validation 9 -> LOSS = 1.13
Validation 9 -> MRR = 84.24
Validation 9 -> BLEU = 52.90, 76.6/59.0/46.7/37.1 (BP=1.000, ratio=1.009, hyp_len=34183, ref_len=33879)
Early stopping patience: 8
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.13 @ validation 1
--> Best MRR so far: 84.24 @ validation 9
--> Best BLEU so far: 53.17 @ validation 7
Starting Epoch 10
Epoch 10 - update      17940 => loss: 0.473 (used GPU: 4391 MiB)
Epoch 10 - update      17970 => loss: 0.634 (used GPU: 4391 MiB)
Epoch 10 - update      18000 => loss: 0.724 (used GPU: 4391 MiB)
Epoch 10 - update      18030 => loss: 0.770 (used GPU: 4391 MiB)
Epoch 10 - update      18060 => loss: 0.267 (used GPU: 4391 MiB)
Epoch 10 - update      18090 => loss: 0.427 (used GPU: 4391 MiB)
Epoch 10 - update      18120 => loss: 0.448 (used GPU: 4391 MiB)
Epoch 10 - update      18150 => loss: 0.478 (used GPU: 4391 MiB)
Epoch 10 - update      18180 => loss: 1.102 (used GPU: 4391 MiB)
Epoch 10 - update      18210 => loss: 0.476 (used GPU: 4391 MiB)
Epoch 10 - update      18240 => loss: 1.086 (used GPU: 4391 MiB)
Epoch 10 - update      18270 => loss: 0.477 (used GPU: 4391 MiB)
Epoch 10 - update      18300 => loss: 0.234 (used GPU: 4391 MiB)
Epoch 10 - update      18330 => loss: 0.363 (used GPU: 4391 MiB)
Epoch 10 - update      18360 => loss: 0.770 (used GPU: 4391 MiB)
Epoch 10 - update      18390 => loss: 0.816 (used GPU: 4391 MiB)
Epoch 10 - update      18420 => loss: 1.039 (used GPU: 4391 MiB)
Epoch 10 - update      18450 => loss: 0.473 (used GPU: 4391 MiB)
Epoch 10 - update      18480 => loss: 0.357 (used GPU: 4391 MiB)
Epoch 10 - update      18510 => loss: 0.821 (used GPU: 4391 MiB)
Epoch 10 - update      18540 => loss: 0.650 (used GPU: 4391 MiB)
Epoch 10 - update      18570 => loss: 1.174 (used GPU: 4391 MiB)
Epoch 10 - update      18600 => loss: 0.229 (used GPU: 4391 MiB)
Epoch 10 - update      18630 => loss: 0.860 (used GPU: 4391 MiB)
Epoch 10 - update      18660 => loss: 0.595 (used GPU: 4391 MiB)
Epoch 10 - update      18690 => loss: 0.971 (used GPU: 4391 MiB)
Epoch 10 - update      18720 => loss: 1.137 (used GPU: 4391 MiB)
Epoch 10 - update      18750 => loss: 0.967 (used GPU: 4391 MiB)
Epoch 10 - update      18780 => loss: 0.683 (used GPU: 4391 MiB)
Epoch 10 - update      18810 => loss: 0.597 (used GPU: 4391 MiB)
Epoch 10 - update      18840 => loss: 0.266 (used GPU: 4391 MiB)
Epoch 10 - update      18870 => loss: 0.692 (used GPU: 4391 MiB)
Epoch 10 - update      18900 => loss: 0.775 (used GPU: 4391 MiB)
Epoch 10 - update      18930 => loss: 0.306 (used GPU: 4391 MiB)
Epoch 10 - update      18960 => loss: 0.783 (used GPU: 4391 MiB)
Epoch 10 - update      18990 => loss: 0.357 (used GPU: 4391 MiB)
Epoch 10 - update      19020 => loss: 0.647 (used GPU: 4391 MiB)
Epoch 10 - update      19050 => loss: 0.333 (used GPU: 4391 MiB)
Epoch 10 - update      19080 => loss: 0.431 (used GPU: 4391 MiB)
Epoch 10 - update      19110 => loss: 0.532 (used GPU: 4391 MiB)
Epoch 10 - update      19140 => loss: 1.052 (used GPU: 4391 MiB)
Epoch 10 - update      19170 => loss: 0.501 (used GPU: 4391 MiB)
Epoch 10 - update      19200 => loss: 0.434 (used GPU: 4391 MiB)
Epoch 10 - update      19230 => loss: 0.278 (used GPU: 4391 MiB)
Epoch 10 - update      19260 => loss: 0.380 (used GPU: 4391 MiB)
Epoch 10 - update      19290 => loss: 0.587 (used GPU: 4391 MiB)
Epoch 10 - update      19320 => loss: 0.958 (used GPU: 4391 MiB)
Epoch 10 - update      19350 => loss: 1.207 (used GPU: 4391 MiB)
Epoch 10 - update      19380 => loss: 0.400 (used GPU: 4391 MiB)
Epoch 10 - update      19410 => loss: 0.199 (used GPU: 4391 MiB)
Epoch 10 - update      19440 => loss: 0.544 (used GPU: 4391 MiB)
Epoch 10 - update      19470 => loss: 0.586 (used GPU: 4391 MiB)
Epoch 10 - update      19500 => loss: 0.454 (used GPU: 4391 MiB)
Epoch 10 - update      19530 => loss: 0.255 (used GPU: 4391 MiB)
Epoch 10 - update      19560 => loss: 0.308 (used GPU: 4391 MiB)
Epoch 10 - update      19590 => loss: 0.755 (used GPU: 4391 MiB)
Epoch 10 - update      19620 => loss: 0.476 (used GPU: 4391 MiB)
Epoch 10 - update      19650 => loss: 0.816 (used GPU: 4391 MiB)
Epoch 10 - update      19680 => loss: 0.600 (used GPU: 4391 MiB)
Epoch 10 - update      19710 => loss: 0.764 (used GPU: 4391 MiB)
Epoch 10 - update      19740 => loss: 0.812 (used GPU: 4391 MiB)
Epoch 10 - update      19770 => loss: 0.429 (used GPU: 4391 MiB)
Epoch 10 - update      19800 => loss: 0.979 (used GPU: 4391 MiB)
Epoch 10 - update      19830 => loss: 0.627 (used GPU: 4391 MiB)
Epoch 10 - update      19860 => loss: 0.813 (used GPU: 4391 MiB)
Epoch 10 - update      19890 => loss: 0.965 (used GPU: 4391 MiB)
--> Epoch 10 finished with mean loss 0.74640
--> Overhead/Training/Evaluation: 0.13/2.80/0.00 mins (total: 2.93 mins)   (1102 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 6.05 sec, Scoring: 0.38 sec (334 sent/sec)
Validation 10 -> LOSS = 1.12
Validation 10 -> MRR = 84.24
Validation 10 -> BLEU = 52.94, 76.4/58.9/46.7/37.3 (BP=1.000, ratio=1.015, hyp_len=34378, ref_len=33879)
** Learning rate changed -> 0.0002
Saving best model based on LOSS
Early stopping patience: 7
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.12 @ validation 10
--> Best MRR so far: 84.24 @ validation 10
--> Best BLEU so far: 53.17 @ validation 7
Starting Epoch 11
Epoch 11 - update      19920 => loss: 0.592 (used GPU: 4391 MiB)
Epoch 11 - update      19950 => loss: 0.357 (used GPU: 4391 MiB)
Epoch 11 - update      19980 => loss: 0.689 (used GPU: 4391 MiB)
Epoch 11 - update      20010 => loss: 0.623 (used GPU: 4391 MiB)
Epoch 11 - update      20040 => loss: 0.288 (used GPU: 4391 MiB)
Epoch 11 - update      20070 => loss: 0.503 (used GPU: 4391 MiB)
Epoch 11 - update      20100 => loss: 0.600 (used GPU: 4391 MiB)
Epoch 11 - update      20130 => loss: 0.737 (used GPU: 4391 MiB)
Epoch 11 - update      20160 => loss: 0.661 (used GPU: 4391 MiB)
Epoch 11 - update      20190 => loss: 0.809 (used GPU: 4391 MiB)
Epoch 11 - update      20220 => loss: 0.503 (used GPU: 4391 MiB)
Epoch 11 - update      20250 => loss: 0.489 (used GPU: 4391 MiB)
Epoch 11 - update      20280 => loss: 0.424 (used GPU: 4391 MiB)
Epoch 11 - update      20310 => loss: 0.448 (used GPU: 4391 MiB)
Epoch 11 - update      20340 => loss: 0.528 (used GPU: 4391 MiB)
Epoch 11 - update      20370 => loss: 0.607 (used GPU: 4391 MiB)
Epoch 11 - update      20400 => loss: 0.208 (used GPU: 4391 MiB)
Epoch 11 - update      20430 => loss: 0.463 (used GPU: 4391 MiB)
Epoch 11 - update      20460 => loss: 0.590 (used GPU: 4391 MiB)
Epoch 11 - update      20490 => loss: 0.351 (used GPU: 4391 MiB)
Epoch 11 - update      20520 => loss: 0.801 (used GPU: 4391 MiB)
Epoch 11 - update      20550 => loss: 0.581 (used GPU: 4391 MiB)
Epoch 11 - update      20580 => loss: 0.716 (used GPU: 4391 MiB)
Epoch 11 - update      20610 => loss: 1.122 (used GPU: 4391 MiB)
Epoch 11 - update      20640 => loss: 0.955 (used GPU: 4391 MiB)
Epoch 11 - update      20670 => loss: 0.778 (used GPU: 4391 MiB)
Epoch 11 - update      20700 => loss: 0.420 (used GPU: 4391 MiB)
Epoch 11 - update      20730 => loss: 0.323 (used GPU: 4391 MiB)
Epoch 11 - update      20760 => loss: 0.923 (used GPU: 4391 MiB)
Epoch 11 - update      20790 => loss: 0.744 (used GPU: 4391 MiB)
Epoch 11 - update      20820 => loss: 0.286 (used GPU: 4391 MiB)
Epoch 11 - update      20850 => loss: 0.422 (used GPU: 4391 MiB)
Epoch 11 - update      20880 => loss: 0.816 (used GPU: 4391 MiB)
Epoch 11 - update      20910 => loss: 0.283 (used GPU: 4391 MiB)
Epoch 11 - update      20940 => loss: 0.904 (used GPU: 4391 MiB)
Epoch 11 - update      20970 => loss: 0.348 (used GPU: 4391 MiB)
Epoch 11 - update      21000 => loss: 0.795 (used GPU: 4391 MiB)
Epoch 11 - update      21030 => loss: 0.924 (used GPU: 4391 MiB)
Epoch 11 - update      21060 => loss: 0.676 (used GPU: 4391 MiB)
Epoch 11 - update      21090 => loss: 0.386 (used GPU: 4391 MiB)
Epoch 11 - update      21120 => loss: 0.432 (used GPU: 4391 MiB)
Epoch 11 - update      21150 => loss: 0.423 (used GPU: 4391 MiB)
Epoch 11 - update      21180 => loss: 0.917 (used GPU: 4391 MiB)
Epoch 11 - update      21210 => loss: 0.619 (used GPU: 4391 MiB)
Epoch 11 - update      21240 => loss: 0.762 (used GPU: 4391 MiB)
Epoch 11 - update      21270 => loss: 0.791 (used GPU: 4391 MiB)
Epoch 11 - update      21300 => loss: 0.598 (used GPU: 4391 MiB)
Epoch 11 - update      21330 => loss: 0.631 (used GPU: 4391 MiB)
Epoch 11 - update      21360 => loss: 0.204 (used GPU: 4391 MiB)
Epoch 11 - update      21390 => loss: 0.330 (used GPU: 4391 MiB)
Epoch 11 - update      21420 => loss: 0.282 (used GPU: 4391 MiB)
Epoch 11 - update      21450 => loss: 0.269 (used GPU: 4391 MiB)
Epoch 11 - update      21480 => loss: 0.659 (used GPU: 4391 MiB)
Epoch 11 - update      21510 => loss: 0.720 (used GPU: 4391 MiB)
Epoch 11 - update      21540 => loss: 0.293 (used GPU: 4391 MiB)
Epoch 11 - update      21570 => loss: 0.409 (used GPU: 4391 MiB)
Epoch 11 - update      21600 => loss: 0.706 (used GPU: 4391 MiB)
Epoch 11 - update      21630 => loss: 1.257 (used GPU: 4391 MiB)
Epoch 11 - update      21660 => loss: 0.232 (used GPU: 4391 MiB)
Epoch 11 - update      21690 => loss: 0.536 (used GPU: 4391 MiB)
Epoch 11 - update      21720 => loss: 0.863 (used GPU: 4391 MiB)
Epoch 11 - update      21750 => loss: 0.349 (used GPU: 4391 MiB)
Epoch 11 - update      21780 => loss: 0.321 (used GPU: 4391 MiB)
Epoch 11 - update      21810 => loss: 0.564 (used GPU: 4391 MiB)
Epoch 11 - update      21840 => loss: 0.854 (used GPU: 4391 MiB)
Epoch 11 - update      21870 => loss: 0.362 (used GPU: 4391 MiB)
Epoch 11 - update      21900 => loss: 0.635 (used GPU: 4391 MiB)
--> Epoch 11 finished with mean loss 0.67690
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.93 mins)   (1103 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.90 sec, Scoring: 0.38 sec (342 sent/sec)
Validation 11 -> LOSS = 1.09
Validation 11 -> MRR = 84.70
Validation 11 -> BLEU = 53.80, 77.1/59.8/47.6/38.2 (BP=1.000, ratio=1.010, hyp_len=34216, ref_len=33879)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.70 @ validation 11
--> Best BLEU so far: 53.80 @ validation 11
Starting Epoch 12
Epoch 12 - update      21930 => loss: 0.397 (used GPU: 4391 MiB)
Epoch 12 - update      21960 => loss: 0.387 (used GPU: 4391 MiB)
Epoch 12 - update      21990 => loss: 0.754 (used GPU: 4391 MiB)
Epoch 12 - update      22020 => loss: 0.820 (used GPU: 4391 MiB)
Epoch 12 - update      22050 => loss: 0.283 (used GPU: 4391 MiB)
Epoch 12 - update      22080 => loss: 1.007 (used GPU: 4391 MiB)
Epoch 12 - update      22110 => loss: 0.326 (used GPU: 4391 MiB)
Epoch 12 - update      22140 => loss: 0.309 (used GPU: 4391 MiB)
Epoch 12 - update      22170 => loss: 0.243 (used GPU: 4391 MiB)
Epoch 12 - update      22200 => loss: 0.706 (used GPU: 4391 MiB)
Epoch 12 - update      22230 => loss: 0.659 (used GPU: 4391 MiB)
Epoch 12 - update      22260 => loss: 0.282 (used GPU: 4391 MiB)
Epoch 12 - update      22290 => loss: 0.286 (used GPU: 4391 MiB)
Epoch 12 - update      22320 => loss: 0.487 (used GPU: 4391 MiB)
Epoch 12 - update      22350 => loss: 0.873 (used GPU: 4391 MiB)
Epoch 12 - update      22380 => loss: 0.579 (used GPU: 4391 MiB)
Epoch 12 - update      22410 => loss: 0.605 (used GPU: 4391 MiB)
Epoch 12 - update      22440 => loss: 0.833 (used GPU: 4391 MiB)
Epoch 12 - update      22470 => loss: 0.129 (used GPU: 4391 MiB)
Epoch 12 - update      22500 => loss: 0.579 (used GPU: 4391 MiB)
Epoch 12 - update      22530 => loss: 0.450 (used GPU: 4391 MiB)
Epoch 12 - update      22560 => loss: 1.040 (used GPU: 4391 MiB)
Epoch 12 - update      22590 => loss: 0.679 (used GPU: 4391 MiB)
Epoch 12 - update      22620 => loss: 0.469 (used GPU: 4391 MiB)
Epoch 12 - update      22650 => loss: 0.531 (used GPU: 4391 MiB)
Epoch 12 - update      22680 => loss: 0.197 (used GPU: 4391 MiB)
Epoch 12 - update      22710 => loss: 0.230 (used GPU: 4391 MiB)
Epoch 12 - update      22740 => loss: 0.523 (used GPU: 4391 MiB)
Epoch 12 - update      22770 => loss: 0.543 (used GPU: 4391 MiB)
Epoch 12 - update      22800 => loss: 0.624 (used GPU: 4391 MiB)
Epoch 12 - update      22830 => loss: 0.744 (used GPU: 4391 MiB)
Epoch 12 - update      22860 => loss: 1.050 (used GPU: 4391 MiB)
Epoch 12 - update      22890 => loss: 0.300 (used GPU: 4391 MiB)
Epoch 12 - update      22920 => loss: 0.476 (used GPU: 4391 MiB)
Epoch 12 - update      22950 => loss: 0.707 (used GPU: 4391 MiB)
Epoch 12 - update      22980 => loss: 0.806 (used GPU: 4391 MiB)
Epoch 12 - update      23010 => loss: 0.355 (used GPU: 4391 MiB)
Epoch 12 - update      23040 => loss: 0.214 (used GPU: 4391 MiB)
Epoch 12 - update      23070 => loss: 0.350 (used GPU: 4391 MiB)
Epoch 12 - update      23100 => loss: 0.309 (used GPU: 4391 MiB)
Epoch 12 - update      23130 => loss: 0.933 (used GPU: 4391 MiB)
Epoch 12 - update      23160 => loss: 0.533 (used GPU: 4391 MiB)
Epoch 12 - update      23190 => loss: 0.552 (used GPU: 4391 MiB)
Epoch 12 - update      23220 => loss: 0.620 (used GPU: 4391 MiB)
Epoch 12 - update      23250 => loss: 0.214 (used GPU: 4391 MiB)
Epoch 12 - update      23280 => loss: 0.535 (used GPU: 4391 MiB)
Epoch 12 - update      23310 => loss: 0.316 (used GPU: 4391 MiB)
Epoch 12 - update      23340 => loss: 0.776 (used GPU: 4391 MiB)
Epoch 12 - update      23370 => loss: 0.525 (used GPU: 4391 MiB)
Epoch 12 - update      23400 => loss: 0.573 (used GPU: 4391 MiB)
Epoch 12 - update      23430 => loss: 0.919 (used GPU: 4391 MiB)
Epoch 12 - update      23460 => loss: 0.342 (used GPU: 4391 MiB)
Epoch 12 - update      23490 => loss: 0.643 (used GPU: 4391 MiB)
Epoch 12 - update      23520 => loss: 0.495 (used GPU: 4391 MiB)
Epoch 12 - update      23550 => loss: 0.382 (used GPU: 4391 MiB)
Epoch 12 - update      23580 => loss: 0.187 (used GPU: 4391 MiB)
Epoch 12 - update      23610 => loss: 0.635 (used GPU: 4391 MiB)
Epoch 12 - update      23640 => loss: 0.432 (used GPU: 4391 MiB)
Epoch 12 - update      23670 => loss: 0.416 (used GPU: 4391 MiB)
Epoch 12 - update      23700 => loss: 0.523 (used GPU: 4391 MiB)
Epoch 12 - update      23730 => loss: 0.535 (used GPU: 4391 MiB)
Epoch 12 - update      23760 => loss: 0.769 (used GPU: 4391 MiB)
Epoch 12 - update      23790 => loss: 0.504 (used GPU: 4391 MiB)
Epoch 12 - update      23820 => loss: 0.963 (used GPU: 4391 MiB)
Epoch 12 - update      23850 => loss: 0.415 (used GPU: 4391 MiB)
Epoch 12 - update      23880 => loss: 0.292 (used GPU: 4391 MiB)
--> Epoch 12 finished with mean loss 0.65678
--> Overhead/Training/Evaluation: 0.13/2.80/0.00 mins (total: 2.93 mins)   (1102 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.97 sec, Scoring: 0.38 sec (338 sent/sec)
Validation 12 -> LOSS = 1.10
Validation 12 -> MRR = 84.74
Validation 12 -> BLEU = 53.65, 76.9/59.7/47.5/38.0 (BP=1.000, ratio=1.010, hyp_len=34205, ref_len=33879)
Early stopping patience: 9
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.74 @ validation 12
--> Best BLEU so far: 53.80 @ validation 11
Starting Epoch 13
Epoch 13 - update      23910 => loss: 0.331 (used GPU: 4391 MiB)
Epoch 13 - update      23940 => loss: 0.350 (used GPU: 4391 MiB)
Epoch 13 - update      23970 => loss: 0.587 (used GPU: 4391 MiB)
Epoch 13 - update      24000 => loss: 0.225 (used GPU: 4391 MiB)
Epoch 13 - update      24030 => loss: 0.630 (used GPU: 4391 MiB)
Epoch 13 - update      24060 => loss: 0.871 (used GPU: 4391 MiB)
Epoch 13 - update      24090 => loss: 0.448 (used GPU: 4391 MiB)
Epoch 13 - update      24120 => loss: 0.245 (used GPU: 4391 MiB)
Epoch 13 - update      24150 => loss: 0.290 (used GPU: 4391 MiB)
Epoch 13 - update      24180 => loss: 0.250 (used GPU: 4391 MiB)
Epoch 13 - update      24210 => loss: 0.379 (used GPU: 4391 MiB)
Epoch 13 - update      24240 => loss: 0.619 (used GPU: 4391 MiB)
Epoch 13 - update      24270 => loss: 0.384 (used GPU: 4391 MiB)
Epoch 13 - update      24300 => loss: 0.873 (used GPU: 4391 MiB)
Epoch 13 - update      24330 => loss: 0.154 (used GPU: 4391 MiB)
Epoch 13 - update      24360 => loss: 0.832 (used GPU: 4391 MiB)
Epoch 13 - update      24390 => loss: 0.599 (used GPU: 4391 MiB)
Epoch 13 - update      24420 => loss: 0.361 (used GPU: 4391 MiB)
Epoch 13 - update      24450 => loss: 0.382 (used GPU: 4391 MiB)
Epoch 13 - update      24480 => loss: 0.651 (used GPU: 4391 MiB)
Epoch 13 - update      24510 => loss: 0.720 (used GPU: 4391 MiB)
Epoch 13 - update      24540 => loss: 0.292 (used GPU: 4391 MiB)
Epoch 13 - update      24570 => loss: 0.218 (used GPU: 4391 MiB)
Epoch 13 - update      24600 => loss: 0.739 (used GPU: 4391 MiB)
Epoch 13 - update      24630 => loss: 0.321 (used GPU: 4391 MiB)
Epoch 13 - update      24660 => loss: 0.256 (used GPU: 4391 MiB)
Epoch 13 - update      24690 => loss: 1.243 (used GPU: 4391 MiB)
Epoch 13 - update      24720 => loss: 0.671 (used GPU: 4391 MiB)
Epoch 13 - update      24750 => loss: 0.359 (used GPU: 4391 MiB)
Epoch 13 - update      24780 => loss: 0.240 (used GPU: 4391 MiB)
Epoch 13 - update      24810 => loss: 0.134 (used GPU: 4391 MiB)
Epoch 13 - update      24840 => loss: 1.029 (used GPU: 4391 MiB)
Epoch 13 - update      24870 => loss: 0.428 (used GPU: 4391 MiB)
Epoch 13 - update      24900 => loss: 0.708 (used GPU: 4391 MiB)
Epoch 13 - update      24930 => loss: 0.553 (used GPU: 4391 MiB)
Epoch 13 - update      24960 => loss: 0.942 (used GPU: 4391 MiB)
Epoch 13 - update      24990 => loss: 0.418 (used GPU: 4391 MiB)
Epoch 13 - update      25020 => loss: 0.273 (used GPU: 4391 MiB)
Epoch 13 - update      25050 => loss: 0.443 (used GPU: 4391 MiB)
Epoch 13 - update      25080 => loss: 0.339 (used GPU: 4391 MiB)
Epoch 13 - update      25110 => loss: 0.555 (used GPU: 4391 MiB)
Epoch 13 - update      25140 => loss: 0.722 (used GPU: 4391 MiB)
Epoch 13 - update      25170 => loss: 0.121 (used GPU: 4391 MiB)
Epoch 13 - update      25200 => loss: 0.340 (used GPU: 4391 MiB)
Epoch 13 - update      25230 => loss: 0.490 (used GPU: 4391 MiB)
Epoch 13 - update      25260 => loss: 0.729 (used GPU: 4391 MiB)
Epoch 13 - update      25290 => loss: 0.196 (used GPU: 4391 MiB)
Epoch 13 - update      25320 => loss: 0.219 (used GPU: 4391 MiB)
Epoch 13 - update      25350 => loss: 0.798 (used GPU: 4391 MiB)
Epoch 13 - update      25380 => loss: 0.633 (used GPU: 4391 MiB)
Epoch 13 - update      25410 => loss: 0.550 (used GPU: 4391 MiB)
Epoch 13 - update      25440 => loss: 1.071 (used GPU: 4391 MiB)
Epoch 13 - update      25470 => loss: 0.775 (used GPU: 4391 MiB)
Epoch 13 - update      25500 => loss: 0.198 (used GPU: 4391 MiB)
Epoch 13 - update      25530 => loss: 0.311 (used GPU: 4391 MiB)
Epoch 13 - update      25560 => loss: 0.199 (used GPU: 4391 MiB)
Epoch 13 - update      25590 => loss: 0.634 (used GPU: 4391 MiB)
Epoch 13 - update      25620 => loss: 0.246 (used GPU: 4391 MiB)
Epoch 13 - update      25650 => loss: 0.474 (used GPU: 4391 MiB)
Epoch 13 - update      25680 => loss: 0.445 (used GPU: 4391 MiB)
Epoch 13 - update      25710 => loss: 0.709 (used GPU: 4391 MiB)
Epoch 13 - update      25740 => loss: 0.249 (used GPU: 4391 MiB)
Epoch 13 - update      25770 => loss: 0.508 (used GPU: 4391 MiB)
Epoch 13 - update      25800 => loss: 0.673 (used GPU: 4391 MiB)
Epoch 13 - update      25830 => loss: 0.454 (used GPU: 4391 MiB)
Epoch 13 - update      25860 => loss: 0.360 (used GPU: 4391 MiB)
--> Epoch 13 finished with mean loss 0.64837
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.94 mins)   (1101 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.88 sec, Scoring: 0.38 sec (344 sent/sec)
Validation 13 -> LOSS = 1.10
Validation 13 -> MRR = 84.76
Validation 13 -> BLEU = 53.90, 77.1/59.8/47.7/38.3 (BP=1.000, ratio=1.007, hyp_len=34133, ref_len=33879)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.76 @ validation 13
--> Best BLEU so far: 53.90 @ validation 13
Starting Epoch 14
Epoch 14 - update      25890 => loss: 0.823 (used GPU: 4391 MiB)
Epoch 14 - update      25920 => loss: 0.744 (used GPU: 4391 MiB)
Epoch 14 - update      25950 => loss: 0.591 (used GPU: 4391 MiB)
Epoch 14 - update      25980 => loss: 0.273 (used GPU: 4391 MiB)
Epoch 14 - update      26010 => loss: 0.772 (used GPU: 4391 MiB)
Epoch 14 - update      26040 => loss: 0.988 (used GPU: 4391 MiB)
Epoch 14 - update      26070 => loss: 0.282 (used GPU: 4391 MiB)
Epoch 14 - update      26100 => loss: 0.699 (used GPU: 4391 MiB)
Epoch 14 - update      26130 => loss: 0.165 (used GPU: 4391 MiB)
Epoch 14 - update      26160 => loss: 0.542 (used GPU: 4391 MiB)
Epoch 14 - update      26190 => loss: 0.182 (used GPU: 4391 MiB)
Epoch 14 - update      26220 => loss: 0.621 (used GPU: 4391 MiB)
Epoch 14 - update      26250 => loss: 0.323 (used GPU: 4391 MiB)
Epoch 14 - update      26280 => loss: 0.690 (used GPU: 4391 MiB)
Epoch 14 - update      26310 => loss: 0.328 (used GPU: 4391 MiB)
Epoch 14 - update      26340 => loss: 0.201 (used GPU: 4391 MiB)
Epoch 14 - update      26370 => loss: 0.549 (used GPU: 4391 MiB)
Epoch 14 - update      26400 => loss: 0.423 (used GPU: 4391 MiB)
Epoch 14 - update      26430 => loss: 0.518 (used GPU: 4391 MiB)
Epoch 14 - update      26460 => loss: 0.889 (used GPU: 4391 MiB)
Epoch 14 - update      26490 => loss: 0.958 (used GPU: 4391 MiB)
Epoch 14 - update      26520 => loss: 0.320 (used GPU: 4391 MiB)
Epoch 14 - update      26550 => loss: 0.205 (used GPU: 4391 MiB)
Epoch 14 - update      26580 => loss: 0.402 (used GPU: 4391 MiB)
Epoch 14 - update      26610 => loss: 0.167 (used GPU: 4391 MiB)
Epoch 14 - update      26640 => loss: 0.735 (used GPU: 4391 MiB)
Epoch 14 - update      26670 => loss: 0.468 (used GPU: 4391 MiB)
Epoch 14 - update      26700 => loss: 0.498 (used GPU: 4391 MiB)
Epoch 14 - update      26730 => loss: 0.577 (used GPU: 4391 MiB)
Epoch 14 - update      26760 => loss: 0.254 (used GPU: 4391 MiB)
Epoch 14 - update      26790 => loss: 0.445 (used GPU: 4391 MiB)
Epoch 14 - update      26820 => loss: 0.387 (used GPU: 4391 MiB)
Epoch 14 - update      26850 => loss: 0.206 (used GPU: 4391 MiB)
Epoch 14 - update      26880 => loss: 0.291 (used GPU: 4391 MiB)
Epoch 14 - update      26910 => loss: 0.952 (used GPU: 4391 MiB)
Epoch 14 - update      26940 => loss: 0.547 (used GPU: 4391 MiB)
Epoch 14 - update      26970 => loss: 0.450 (used GPU: 4391 MiB)
Epoch 14 - update      27000 => loss: 0.233 (used GPU: 4391 MiB)
Epoch 14 - update      27030 => loss: 0.261 (used GPU: 4391 MiB)
Epoch 14 - update      27060 => loss: 0.897 (used GPU: 4391 MiB)
Epoch 14 - update      27090 => loss: 0.365 (used GPU: 4391 MiB)
Epoch 14 - update      27120 => loss: 0.389 (used GPU: 4391 MiB)
Epoch 14 - update      27150 => loss: 0.585 (used GPU: 4391 MiB)
Epoch 14 - update      27180 => loss: 0.351 (used GPU: 4391 MiB)
Epoch 14 - update      27210 => loss: 0.547 (used GPU: 4391 MiB)
Epoch 14 - update      27240 => loss: 0.898 (used GPU: 4391 MiB)
Epoch 14 - update      27270 => loss: 0.391 (used GPU: 4391 MiB)
Epoch 14 - update      27300 => loss: 0.820 (used GPU: 4391 MiB)
Epoch 14 - update      27330 => loss: 1.073 (used GPU: 4391 MiB)
Epoch 14 - update      27360 => loss: 0.426 (used GPU: 4391 MiB)
Epoch 14 - update      27390 => loss: 0.581 (used GPU: 4391 MiB)
Epoch 14 - update      27420 => loss: 0.433 (used GPU: 4391 MiB)
Epoch 14 - update      27450 => loss: 0.350 (used GPU: 4391 MiB)
Epoch 14 - update      27480 => loss: 0.849 (used GPU: 4391 MiB)
Epoch 14 - update      27510 => loss: 0.505 (used GPU: 4391 MiB)
Epoch 14 - update      27540 => loss: 0.269 (used GPU: 4391 MiB)
Epoch 14 - update      27570 => loss: 0.638 (used GPU: 4391 MiB)
Epoch 14 - update      27600 => loss: 0.380 (used GPU: 4391 MiB)
Epoch 14 - update      27630 => loss: 0.670 (used GPU: 4391 MiB)
Epoch 14 - update      27660 => loss: 0.370 (used GPU: 4391 MiB)
Epoch 14 - update      27690 => loss: 0.666 (used GPU: 4391 MiB)
Epoch 14 - update      27720 => loss: 0.250 (used GPU: 4391 MiB)
Epoch 14 - update      27750 => loss: 0.571 (used GPU: 4391 MiB)
Epoch 14 - update      27780 => loss: 0.381 (used GPU: 4391 MiB)
Epoch 14 - update      27810 => loss: 0.440 (used GPU: 4391 MiB)
Epoch 14 - update      27840 => loss: 0.322 (used GPU: 4391 MiB)
Epoch 14 - update      27870 => loss: 0.536 (used GPU: 4391 MiB)
--> Epoch 14 finished with mean loss 0.64187
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.94 mins)   (1100 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.92 sec, Scoring: 0.38 sec (341 sent/sec)
Validation 14 -> LOSS = 1.10
Validation 14 -> MRR = 84.72
Validation 14 -> BLEU = 53.78, 77.0/59.7/47.6/38.3 (BP=1.000, ratio=1.008, hyp_len=34159, ref_len=33879)
Early stopping patience: 9
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.76 @ validation 13
--> Best BLEU so far: 53.90 @ validation 13
Starting Epoch 15
Epoch 15 - update      27900 => loss: 0.436 (used GPU: 4391 MiB)
Epoch 15 - update      27930 => loss: 0.641 (used GPU: 4391 MiB)
Epoch 15 - update      27960 => loss: 0.371 (used GPU: 4391 MiB)
Epoch 15 - update      27990 => loss: 0.234 (used GPU: 4391 MiB)
Epoch 15 - update      28020 => loss: 0.472 (used GPU: 4391 MiB)
Epoch 15 - update      28050 => loss: 0.513 (used GPU: 4391 MiB)
Epoch 15 - update      28080 => loss: 0.381 (used GPU: 4391 MiB)
Epoch 15 - update      28110 => loss: 0.620 (used GPU: 4391 MiB)
Epoch 15 - update      28140 => loss: 0.749 (used GPU: 4391 MiB)
Epoch 15 - update      28170 => loss: 0.724 (used GPU: 4391 MiB)
Epoch 15 - update      28200 => loss: 0.190 (used GPU: 4391 MiB)
Epoch 15 - update      28230 => loss: 0.351 (used GPU: 4391 MiB)
Epoch 15 - update      28260 => loss: 0.278 (used GPU: 4391 MiB)
Epoch 15 - update      28290 => loss: 0.617 (used GPU: 4391 MiB)
Epoch 15 - update      28320 => loss: 0.468 (used GPU: 4391 MiB)
Epoch 15 - update      28350 => loss: 1.032 (used GPU: 4391 MiB)
Epoch 15 - update      28380 => loss: 0.450 (used GPU: 4391 MiB)
Epoch 15 - update      28410 => loss: 0.238 (used GPU: 4391 MiB)
Epoch 15 - update      28440 => loss: 0.641 (used GPU: 4391 MiB)
Epoch 15 - update      28470 => loss: 0.229 (used GPU: 4391 MiB)
Epoch 15 - update      28500 => loss: 0.206 (used GPU: 4391 MiB)
Epoch 15 - update      28530 => loss: 0.218 (used GPU: 4391 MiB)
Epoch 15 - update      28560 => loss: 0.252 (used GPU: 4391 MiB)
Epoch 15 - update      28590 => loss: 0.237 (used GPU: 4391 MiB)
Epoch 15 - update      28620 => loss: 0.818 (used GPU: 4391 MiB)
Epoch 15 - update      28650 => loss: 0.212 (used GPU: 4391 MiB)
Epoch 15 - update      28680 => loss: 0.496 (used GPU: 4391 MiB)
Epoch 15 - update      28710 => loss: 0.376 (used GPU: 4391 MiB)
Epoch 15 - update      28740 => loss: 0.577 (used GPU: 4391 MiB)
Epoch 15 - update      28770 => loss: 0.605 (used GPU: 4391 MiB)
Epoch 15 - update      28800 => loss: 0.319 (used GPU: 4391 MiB)
Epoch 15 - update      28830 => loss: 0.446 (used GPU: 4391 MiB)
Epoch 15 - update      28860 => loss: 0.213 (used GPU: 4391 MiB)
Epoch 15 - update      28890 => loss: 0.992 (used GPU: 4391 MiB)
Epoch 15 - update      28920 => loss: 0.827 (used GPU: 4391 MiB)
Epoch 15 - update      28950 => loss: 0.409 (used GPU: 4391 MiB)
Epoch 15 - update      28980 => loss: 0.374 (used GPU: 4391 MiB)
Epoch 15 - update      29010 => loss: 0.699 (used GPU: 4391 MiB)
Epoch 15 - update      29040 => loss: 0.585 (used GPU: 4391 MiB)
Epoch 15 - update      29070 => loss: 0.554 (used GPU: 4391 MiB)
Epoch 15 - update      29100 => loss: 0.684 (used GPU: 4391 MiB)
Epoch 15 - update      29130 => loss: 0.305 (used GPU: 4391 MiB)
Epoch 15 - update      29160 => loss: 0.360 (used GPU: 4391 MiB)
Epoch 15 - update      29190 => loss: 0.591 (used GPU: 4391 MiB)
Epoch 15 - update      29220 => loss: 0.348 (used GPU: 4391 MiB)
Epoch 15 - update      29250 => loss: 0.517 (used GPU: 4391 MiB)
Epoch 15 - update      29280 => loss: 0.288 (used GPU: 4391 MiB)
Epoch 15 - update      29310 => loss: 0.396 (used GPU: 4391 MiB)
Epoch 15 - update      29340 => loss: 0.436 (used GPU: 4391 MiB)
Epoch 15 - update      29370 => loss: 0.516 (used GPU: 4391 MiB)
Epoch 15 - update      29400 => loss: 0.241 (used GPU: 4391 MiB)
Epoch 15 - update      29430 => loss: 0.243 (used GPU: 4391 MiB)
Epoch 15 - update      29460 => loss: 0.499 (used GPU: 4391 MiB)
Epoch 15 - update      29490 => loss: 0.410 (used GPU: 4391 MiB)
Epoch 15 - update      29520 => loss: 0.356 (used GPU: 4391 MiB)
Epoch 15 - update      29550 => loss: 0.298 (used GPU: 4391 MiB)
Epoch 15 - update      29580 => loss: 1.057 (used GPU: 4391 MiB)
Epoch 15 - update      29610 => loss: 1.032 (used GPU: 4391 MiB)
Epoch 15 - update      29640 => loss: 0.728 (used GPU: 4391 MiB)
Epoch 15 - update      29670 => loss: 0.587 (used GPU: 4391 MiB)
Epoch 15 - update      29700 => loss: 0.329 (used GPU: 4391 MiB)
Epoch 15 - update      29730 => loss: 0.872 (used GPU: 4391 MiB)
Epoch 15 - update      29760 => loss: 0.178 (used GPU: 4391 MiB)
Epoch 15 - update      29790 => loss: 0.652 (used GPU: 4391 MiB)
Epoch 15 - update      29820 => loss: 0.604 (used GPU: 4391 MiB)
Epoch 15 - update      29850 => loss: 0.307 (used GPU: 4391 MiB)
--> Epoch 15 finished with mean loss 0.63745
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.94 mins)   (1101 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.93 sec, Scoring: 0.38 sec (340 sent/sec)
Validation 15 -> LOSS = 1.11
Validation 15 -> MRR = 84.76
Validation 15 -> BLEU = 53.91, 77.1/59.9/47.7/38.3 (BP=1.000, ratio=1.009, hyp_len=34182, ref_len=33879)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.76 @ validation 15
--> Best BLEU so far: 53.91 @ validation 15
Starting Epoch 16
Epoch 16 - update      29880 => loss: 0.237 (used GPU: 4391 MiB)
Epoch 16 - update      29910 => loss: 0.168 (used GPU: 4391 MiB)
Epoch 16 - update      29940 => loss: 0.819 (used GPU: 4391 MiB)
Epoch 16 - update      29970 => loss: 0.811 (used GPU: 4391 MiB)
Epoch 16 - update      30000 => loss: 0.501 (used GPU: 4391 MiB)
Epoch 16 - update      30030 => loss: 0.563 (used GPU: 4391 MiB)
Epoch 16 - update      30060 => loss: 0.418 (used GPU: 4391 MiB)
Epoch 16 - update      30090 => loss: 0.397 (used GPU: 4391 MiB)
Epoch 16 - update      30120 => loss: 0.247 (used GPU: 4391 MiB)
Epoch 16 - update      30150 => loss: 0.703 (used GPU: 4391 MiB)
Epoch 16 - update      30180 => loss: 0.473 (used GPU: 4391 MiB)
Epoch 16 - update      30210 => loss: 0.707 (used GPU: 4391 MiB)
Epoch 16 - update      30240 => loss: 0.399 (used GPU: 4391 MiB)
Epoch 16 - update      30270 => loss: 0.427 (used GPU: 4391 MiB)
Epoch 16 - update      30300 => loss: 0.668 (used GPU: 4391 MiB)
Epoch 16 - update      30330 => loss: 0.262 (used GPU: 4391 MiB)
Epoch 16 - update      30360 => loss: 0.188 (used GPU: 4391 MiB)
Epoch 16 - update      30390 => loss: 0.621 (used GPU: 4391 MiB)
Epoch 16 - update      30420 => loss: 0.173 (used GPU: 4391 MiB)
Epoch 16 - update      30450 => loss: 0.463 (used GPU: 4391 MiB)
Epoch 16 - update      30480 => loss: 0.361 (used GPU: 4391 MiB)
Epoch 16 - update      30510 => loss: 1.110 (used GPU: 4391 MiB)
Epoch 16 - update      30540 => loss: 0.521 (used GPU: 4391 MiB)
Epoch 16 - update      30570 => loss: 0.340 (used GPU: 4391 MiB)
Epoch 16 - update      30600 => loss: 0.467 (used GPU: 4391 MiB)
Epoch 16 - update      30630 => loss: 0.378 (used GPU: 4391 MiB)
Epoch 16 - update      30660 => loss: 0.366 (used GPU: 4391 MiB)
Epoch 16 - update      30690 => loss: 0.443 (used GPU: 4391 MiB)
Epoch 16 - update      30720 => loss: 0.311 (used GPU: 4391 MiB)
Epoch 16 - update      30750 => loss: 0.646 (used GPU: 4391 MiB)
Epoch 16 - update      30780 => loss: 0.431 (used GPU: 4391 MiB)
Epoch 16 - update      30810 => loss: 0.218 (used GPU: 4391 MiB)
Epoch 16 - update      30840 => loss: 0.700 (used GPU: 4391 MiB)
Epoch 16 - update      30870 => loss: 1.178 (used GPU: 4391 MiB)
Epoch 16 - update      30900 => loss: 0.838 (used GPU: 4391 MiB)
Epoch 16 - update      30930 => loss: 0.950 (used GPU: 4391 MiB)
Epoch 16 - update      30960 => loss: 0.525 (used GPU: 4391 MiB)
Epoch 16 - update      30990 => loss: 0.719 (used GPU: 4391 MiB)
Epoch 16 - update      31020 => loss: 0.239 (used GPU: 4391 MiB)
Epoch 16 - update      31050 => loss: 0.134 (used GPU: 4391 MiB)
Epoch 16 - update      31080 => loss: 0.778 (used GPU: 4391 MiB)
Epoch 16 - update      31110 => loss: 0.297 (used GPU: 4391 MiB)
Epoch 16 - update      31140 => loss: 0.686 (used GPU: 4391 MiB)
Epoch 16 - update      31170 => loss: 0.114 (used GPU: 4391 MiB)
Epoch 16 - update      31200 => loss: 1.054 (used GPU: 4391 MiB)
Epoch 16 - update      31230 => loss: 0.446 (used GPU: 4391 MiB)
Epoch 16 - update      31260 => loss: 0.814 (used GPU: 4391 MiB)
Epoch 16 - update      31290 => loss: 0.128 (used GPU: 4391 MiB)
Epoch 16 - update      31320 => loss: 0.652 (used GPU: 4391 MiB)
Epoch 16 - update      31350 => loss: 0.262 (used GPU: 4391 MiB)
Epoch 16 - update      31380 => loss: 0.344 (used GPU: 4391 MiB)
Epoch 16 - update      31410 => loss: 0.680 (used GPU: 4391 MiB)
Epoch 16 - update      31440 => loss: 0.326 (used GPU: 4391 MiB)
Epoch 16 - update      31470 => loss: 0.783 (used GPU: 4391 MiB)
Epoch 16 - update      31500 => loss: 0.320 (used GPU: 4391 MiB)
Epoch 16 - update      31530 => loss: 0.235 (used GPU: 4391 MiB)
Epoch 16 - update      31560 => loss: 0.435 (used GPU: 4391 MiB)
Epoch 16 - update      31590 => loss: 0.368 (used GPU: 4391 MiB)
Epoch 16 - update      31620 => loss: 0.489 (used GPU: 4391 MiB)
Epoch 16 - update      31650 => loss: 0.402 (used GPU: 4391 MiB)
Epoch 16 - update      31680 => loss: 0.796 (used GPU: 4391 MiB)
Epoch 16 - update      31710 => loss: 0.843 (used GPU: 4391 MiB)
Epoch 16 - update      31740 => loss: 0.246 (used GPU: 4391 MiB)
Epoch 16 - update      31770 => loss: 0.245 (used GPU: 4391 MiB)
Epoch 16 - update      31800 => loss: 0.541 (used GPU: 4391 MiB)
Epoch 16 - update      31830 => loss: 0.202 (used GPU: 4391 MiB)
--> Epoch 16 finished with mean loss 0.63285
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.94 mins)   (1102 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.94 sec, Scoring: 0.38 sec (340 sent/sec)
Validation 16 -> LOSS = 1.11
Validation 16 -> MRR = 84.69
Validation 16 -> BLEU = 53.64, 77.0/59.7/47.4/37.9 (BP=1.000, ratio=1.009, hyp_len=34167, ref_len=33879)
Early stopping patience: 9
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.76 @ validation 15
--> Best BLEU so far: 53.91 @ validation 15
Starting Epoch 17
Epoch 17 - update      31860 => loss: 0.757 (used GPU: 4391 MiB)
Epoch 17 - update      31890 => loss: 0.332 (used GPU: 4391 MiB)
Epoch 17 - update      31920 => loss: 0.411 (used GPU: 4391 MiB)
Epoch 17 - update      31950 => loss: 0.237 (used GPU: 4391 MiB)
Epoch 17 - update      31980 => loss: 0.351 (used GPU: 4391 MiB)
Epoch 17 - update      32010 => loss: 0.804 (used GPU: 4391 MiB)
Epoch 17 - update      32040 => loss: 0.717 (used GPU: 4391 MiB)
Epoch 17 - update      32070 => loss: 0.610 (used GPU: 4391 MiB)
Epoch 17 - update      32100 => loss: 0.372 (used GPU: 4391 MiB)
Epoch 17 - update      32130 => loss: 0.239 (used GPU: 4391 MiB)
Epoch 17 - update      32160 => loss: 0.394 (used GPU: 4391 MiB)
Epoch 17 - update      32190 => loss: 0.321 (used GPU: 4391 MiB)
Epoch 17 - update      32220 => loss: 0.271 (used GPU: 4391 MiB)
Epoch 17 - update      32250 => loss: 0.713 (used GPU: 4391 MiB)
Epoch 17 - update      32280 => loss: 0.403 (used GPU: 4391 MiB)
Epoch 17 - update      32310 => loss: 0.465 (used GPU: 4391 MiB)
Epoch 17 - update      32340 => loss: 0.265 (used GPU: 4391 MiB)
Epoch 17 - update      32370 => loss: 0.510 (used GPU: 4391 MiB)
Epoch 17 - update      32400 => loss: 0.149 (used GPU: 4391 MiB)
Epoch 17 - update      32430 => loss: 0.256 (used GPU: 4391 MiB)
Epoch 17 - update      32460 => loss: 1.018 (used GPU: 4391 MiB)
Epoch 17 - update      32490 => loss: 0.281 (used GPU: 4391 MiB)
Epoch 17 - update      32520 => loss: 0.439 (used GPU: 4391 MiB)
Epoch 17 - update      32550 => loss: 0.197 (used GPU: 4391 MiB)
Epoch 17 - update      32580 => loss: 0.810 (used GPU: 4391 MiB)
Epoch 17 - update      32610 => loss: 0.383 (used GPU: 4391 MiB)
Epoch 17 - update      32640 => loss: 0.631 (used GPU: 4391 MiB)
Epoch 17 - update      32670 => loss: 0.161 (used GPU: 4391 MiB)
Epoch 17 - update      32700 => loss: 0.410 (used GPU: 4391 MiB)
Epoch 17 - update      32730 => loss: 0.523 (used GPU: 4391 MiB)
Epoch 17 - update      32760 => loss: 0.823 (used GPU: 4391 MiB)
Epoch 17 - update      32790 => loss: 0.142 (used GPU: 4391 MiB)
Epoch 17 - update      32820 => loss: 0.529 (used GPU: 4391 MiB)
Epoch 17 - update      32850 => loss: 0.302 (used GPU: 4391 MiB)
Epoch 17 - update      32880 => loss: 0.208 (used GPU: 4391 MiB)
Epoch 17 - update      32910 => loss: 0.326 (used GPU: 4391 MiB)
Epoch 17 - update      32940 => loss: 0.278 (used GPU: 4391 MiB)
Epoch 17 - update      32970 => loss: 0.797 (used GPU: 4391 MiB)
Epoch 17 - update      33000 => loss: 0.329 (used GPU: 4391 MiB)
Epoch 17 - update      33030 => loss: 0.185 (used GPU: 4391 MiB)
Epoch 17 - update      33060 => loss: 0.313 (used GPU: 4391 MiB)
Epoch 17 - update      33090 => loss: 0.516 (used GPU: 4391 MiB)
Epoch 17 - update      33120 => loss: 0.421 (used GPU: 4391 MiB)
Epoch 17 - update      33150 => loss: 0.366 (used GPU: 4391 MiB)
Epoch 17 - update      33180 => loss: 0.565 (used GPU: 4391 MiB)
Epoch 17 - update      33210 => loss: 0.431 (used GPU: 4391 MiB)
Epoch 17 - update      33240 => loss: 0.320 (used GPU: 4391 MiB)
Epoch 17 - update      33270 => loss: 0.276 (used GPU: 4391 MiB)
Epoch 17 - update      33300 => loss: 0.764 (used GPU: 4391 MiB)
Epoch 17 - update      33330 => loss: 0.291 (used GPU: 4391 MiB)
Epoch 17 - update      33360 => loss: 0.181 (used GPU: 4391 MiB)
Epoch 17 - update      33390 => loss: 0.211 (used GPU: 4391 MiB)
Epoch 17 - update      33420 => loss: 0.498 (used GPU: 4391 MiB)
Epoch 17 - update      33450 => loss: 0.535 (used GPU: 4391 MiB)
Epoch 17 - update      33480 => loss: 0.645 (used GPU: 4391 MiB)
Epoch 17 - update      33510 => loss: 0.864 (used GPU: 4391 MiB)
Epoch 17 - update      33540 => loss: 0.579 (used GPU: 4391 MiB)
Epoch 17 - update      33570 => loss: 0.554 (used GPU: 4391 MiB)
Epoch 17 - update      33600 => loss: 0.529 (used GPU: 4391 MiB)
Epoch 17 - update      33630 => loss: 0.338 (used GPU: 4391 MiB)
Epoch 17 - update      33660 => loss: 0.124 (used GPU: 4391 MiB)
Epoch 17 - update      33690 => loss: 0.211 (used GPU: 4391 MiB)
Epoch 17 - update      33720 => loss: 0.611 (used GPU: 4391 MiB)
Epoch 17 - update      33750 => loss: 0.754 (used GPU: 4391 MiB)
Epoch 17 - update      33780 => loss: 0.282 (used GPU: 4391 MiB)
Epoch 17 - update      33810 => loss: 0.559 (used GPU: 4391 MiB)
Epoch 17 - update      33840 => loss: 0.718 (used GPU: 4391 MiB)
--> Epoch 17 finished with mean loss 0.62793
--> Overhead/Training/Evaluation: 0.14/2.81/0.00 mins (total: 2.94 mins)   (1099 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.99 sec, Scoring: 0.38 sec (337 sent/sec)
Validation 17 -> LOSS = 1.12
Validation 17 -> MRR = 84.59
Validation 17 -> BLEU = 53.27, 76.5/59.4/47.1/37.6 (BP=1.000, ratio=1.017, hyp_len=34443, ref_len=33879)
Early stopping patience: 8
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.76 @ validation 15
--> Best BLEU so far: 53.91 @ validation 15
Starting Epoch 18
Epoch 18 - update      33870 => loss: 0.396 (used GPU: 4391 MiB)
Epoch 18 - update      33900 => loss: 0.734 (used GPU: 4391 MiB)
Epoch 18 - update      33930 => loss: 0.274 (used GPU: 4391 MiB)
Epoch 18 - update      33960 => loss: 0.456 (used GPU: 4391 MiB)
Epoch 18 - update      33990 => loss: 0.369 (used GPU: 4391 MiB)
Epoch 18 - update      34020 => loss: 0.155 (used GPU: 4391 MiB)
Epoch 18 - update      34050 => loss: 0.169 (used GPU: 4391 MiB)
Epoch 18 - update      34080 => loss: 0.429 (used GPU: 4391 MiB)
Epoch 18 - update      34110 => loss: 0.687 (used GPU: 4391 MiB)
Epoch 18 - update      34140 => loss: 0.560 (used GPU: 4391 MiB)
Epoch 18 - update      34170 => loss: 0.297 (used GPU: 4391 MiB)
Epoch 18 - update      34200 => loss: 0.758 (used GPU: 4391 MiB)
Epoch 18 - update      34230 => loss: 0.823 (used GPU: 4391 MiB)
Epoch 18 - update      34260 => loss: 0.375 (used GPU: 4391 MiB)
Epoch 18 - update      34290 => loss: 0.225 (used GPU: 4391 MiB)
Epoch 18 - update      34320 => loss: 0.287 (used GPU: 4391 MiB)
Epoch 18 - update      34350 => loss: 1.069 (used GPU: 4391 MiB)
Epoch 18 - update      34380 => loss: 0.740 (used GPU: 4391 MiB)
Epoch 18 - update      34410 => loss: 0.212 (used GPU: 4391 MiB)
Epoch 18 - update      34440 => loss: 0.206 (used GPU: 4391 MiB)
Epoch 18 - update      34470 => loss: 0.279 (used GPU: 4391 MiB)
Epoch 18 - update      34500 => loss: 0.737 (used GPU: 4391 MiB)
Epoch 18 - update      34530 => loss: 0.943 (used GPU: 4391 MiB)
Epoch 18 - update      34560 => loss: 0.180 (used GPU: 4391 MiB)
Epoch 18 - update      34590 => loss: 0.428 (used GPU: 4391 MiB)
Epoch 18 - update      34620 => loss: 0.904 (used GPU: 4391 MiB)
Epoch 18 - update      34650 => loss: 0.311 (used GPU: 4391 MiB)
Epoch 18 - update      34680 => loss: 0.679 (used GPU: 4391 MiB)
Epoch 18 - update      34710 => loss: 0.745 (used GPU: 4391 MiB)
Epoch 18 - update      34740 => loss: 0.897 (used GPU: 4391 MiB)
Epoch 18 - update      34770 => loss: 0.621 (used GPU: 4391 MiB)
Epoch 18 - update      34800 => loss: 0.352 (used GPU: 4391 MiB)
Epoch 18 - update      34830 => loss: 0.457 (used GPU: 4391 MiB)
Epoch 18 - update      34860 => loss: 0.374 (used GPU: 4391 MiB)
Epoch 18 - update      34890 => loss: 0.463 (used GPU: 4391 MiB)
Epoch 18 - update      34920 => loss: 0.507 (used GPU: 4391 MiB)
Epoch 18 - update      34950 => loss: 0.199 (used GPU: 4391 MiB)
Epoch 18 - update      34980 => loss: 0.242 (used GPU: 4391 MiB)
Epoch 18 - update      35010 => loss: 0.838 (used GPU: 4391 MiB)
Epoch 18 - update      35040 => loss: 0.168 (used GPU: 4391 MiB)
Epoch 18 - update      35070 => loss: 0.581 (used GPU: 4391 MiB)
Epoch 18 - update      35100 => loss: 0.726 (used GPU: 4391 MiB)
Epoch 18 - update      35130 => loss: 0.345 (used GPU: 4391 MiB)
Epoch 18 - update      35160 => loss: 0.232 (used GPU: 4391 MiB)
Epoch 18 - update      35190 => loss: 0.897 (used GPU: 4391 MiB)
Epoch 18 - update      35220 => loss: 0.305 (used GPU: 4391 MiB)
Epoch 18 - update      35250 => loss: 0.171 (used GPU: 4391 MiB)
Epoch 18 - update      35280 => loss: 0.159 (used GPU: 4391 MiB)
Epoch 18 - update      35310 => loss: 0.638 (used GPU: 4391 MiB)
Epoch 18 - update      35340 => loss: 0.170 (used GPU: 4391 MiB)
Epoch 18 - update      35370 => loss: 0.480 (used GPU: 4391 MiB)
Epoch 18 - update      35400 => loss: 0.314 (used GPU: 4391 MiB)
Epoch 18 - update      35430 => loss: 0.463 (used GPU: 4391 MiB)
Epoch 18 - update      35460 => loss: 0.501 (used GPU: 4391 MiB)
Epoch 18 - update      35490 => loss: 0.688 (used GPU: 4391 MiB)
Epoch 18 - update      35520 => loss: 0.283 (used GPU: 4391 MiB)
Epoch 18 - update      35550 => loss: 0.532 (used GPU: 4391 MiB)
Epoch 18 - update      35580 => loss: 0.540 (used GPU: 4391 MiB)
Epoch 18 - update      35610 => loss: 0.360 (used GPU: 4391 MiB)
Epoch 18 - update      35640 => loss: 0.751 (used GPU: 4391 MiB)
Epoch 18 - update      35670 => loss: 0.300 (used GPU: 4391 MiB)
Epoch 18 - update      35700 => loss: 0.534 (used GPU: 4391 MiB)
Epoch 18 - update      35730 => loss: 0.501 (used GPU: 4391 MiB)
Epoch 18 - update      35760 => loss: 0.301 (used GPU: 4391 MiB)
Epoch 18 - update      35790 => loss: 0.641 (used GPU: 4391 MiB)
Epoch 18 - update      35820 => loss: 0.920 (used GPU: 4391 MiB)
--> Epoch 18 finished with mean loss 0.62404
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.94 mins)   (1100 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.91 sec, Scoring: 0.39 sec (341 sent/sec)
Validation 18 -> LOSS = 1.12
Validation 18 -> MRR = 84.76
Validation 18 -> BLEU = 54.11, 77.0/60.0/48.0/38.7 (BP=1.000, ratio=1.012, hyp_len=34287, ref_len=33879)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.76 @ validation 15
--> Best BLEU so far: 54.11 @ validation 18
Starting Epoch 19
Epoch 19 - update      35850 => loss: 0.216 (used GPU: 4391 MiB)
Epoch 19 - update      35880 => loss: 0.230 (used GPU: 4391 MiB)
Epoch 19 - update      35910 => loss: 0.544 (used GPU: 4391 MiB)
Epoch 19 - update      35940 => loss: 0.540 (used GPU: 4391 MiB)
Epoch 19 - update      35970 => loss: 0.198 (used GPU: 4391 MiB)
Epoch 19 - update      36000 => loss: 0.247 (used GPU: 4391 MiB)
Epoch 19 - update      36030 => loss: 0.597 (used GPU: 4391 MiB)
Epoch 19 - update      36060 => loss: 0.912 (used GPU: 4391 MiB)
Epoch 19 - update      36090 => loss: 0.232 (used GPU: 4391 MiB)
Epoch 19 - update      36120 => loss: 0.726 (used GPU: 4391 MiB)
Epoch 19 - update      36150 => loss: 0.303 (used GPU: 4391 MiB)
Epoch 19 - update      36180 => loss: 0.646 (used GPU: 4391 MiB)
Epoch 19 - update      36210 => loss: 0.444 (used GPU: 4391 MiB)
Epoch 19 - update      36240 => loss: 0.719 (used GPU: 4391 MiB)
Epoch 19 - update      36270 => loss: 0.259 (used GPU: 4391 MiB)
Epoch 19 - update      36300 => loss: 0.661 (used GPU: 4391 MiB)
Epoch 19 - update      36330 => loss: 0.264 (used GPU: 4391 MiB)
Epoch 19 - update      36360 => loss: 0.338 (used GPU: 4391 MiB)
Epoch 19 - update      36390 => loss: 0.213 (used GPU: 4391 MiB)
Epoch 19 - update      36420 => loss: 0.417 (used GPU: 4391 MiB)
Epoch 19 - update      36450 => loss: 0.645 (used GPU: 4391 MiB)
Epoch 19 - update      36480 => loss: 1.029 (used GPU: 4391 MiB)
Epoch 19 - update      36510 => loss: 0.601 (used GPU: 4391 MiB)
Epoch 19 - update      36540 => loss: 0.769 (used GPU: 4391 MiB)
Epoch 19 - update      36570 => loss: 0.438 (used GPU: 4391 MiB)
Epoch 19 - update      36600 => loss: 0.433 (used GPU: 4391 MiB)
Epoch 19 - update      36630 => loss: 0.372 (used GPU: 4391 MiB)
Epoch 19 - update      36660 => loss: 0.756 (used GPU: 4391 MiB)
Epoch 19 - update      36690 => loss: 0.234 (used GPU: 4391 MiB)
Epoch 19 - update      36720 => loss: 0.810 (used GPU: 4391 MiB)
Epoch 19 - update      36750 => loss: 0.508 (used GPU: 4391 MiB)
Epoch 19 - update      36780 => loss: 0.278 (used GPU: 4391 MiB)
Epoch 19 - update      36810 => loss: 0.298 (used GPU: 4391 MiB)
Epoch 19 - update      36840 => loss: 0.114 (used GPU: 4391 MiB)
Epoch 19 - update      36870 => loss: 0.289 (used GPU: 4391 MiB)
Epoch 19 - update      36900 => loss: 0.364 (used GPU: 4391 MiB)
Epoch 19 - update      36930 => loss: 0.380 (used GPU: 4391 MiB)
Epoch 19 - update      36960 => loss: 0.488 (used GPU: 4391 MiB)
Epoch 19 - update      36990 => loss: 0.556 (used GPU: 4391 MiB)
Epoch 19 - update      37020 => loss: 0.507 (used GPU: 4391 MiB)
Epoch 19 - update      37050 => loss: 0.696 (used GPU: 4391 MiB)
Epoch 19 - update      37080 => loss: 0.507 (used GPU: 4391 MiB)
Epoch 19 - update      37110 => loss: 0.372 (used GPU: 4391 MiB)
Epoch 19 - update      37140 => loss: 0.312 (used GPU: 4391 MiB)
Epoch 19 - update      37170 => loss: 0.517 (used GPU: 4391 MiB)
Epoch 19 - update      37200 => loss: 0.519 (used GPU: 4391 MiB)
Epoch 19 - update      37230 => loss: 0.405 (used GPU: 4391 MiB)
Epoch 19 - update      37260 => loss: 0.728 (used GPU: 4391 MiB)
Epoch 19 - update      37290 => loss: 0.517 (used GPU: 4391 MiB)
Epoch 19 - update      37320 => loss: 0.402 (used GPU: 4391 MiB)
Epoch 19 - update      37350 => loss: 0.518 (used GPU: 4391 MiB)
Epoch 19 - update      37380 => loss: 0.775 (used GPU: 4391 MiB)
Epoch 19 - update      37410 => loss: 0.393 (used GPU: 4391 MiB)
Epoch 19 - update      37440 => loss: 0.343 (used GPU: 4391 MiB)
Epoch 19 - update      37470 => loss: 0.245 (used GPU: 4391 MiB)
Epoch 19 - update      37500 => loss: 0.390 (used GPU: 4391 MiB)
Epoch 19 - update      37530 => loss: 0.530 (used GPU: 4391 MiB)
Epoch 19 - update      37560 => loss: 0.283 (used GPU: 4391 MiB)
Epoch 19 - update      37590 => loss: 0.383 (used GPU: 4391 MiB)
Epoch 19 - update      37620 => loss: 0.317 (used GPU: 4391 MiB)
Epoch 19 - update      37650 => loss: 0.388 (used GPU: 4391 MiB)
Epoch 19 - update      37680 => loss: 0.628 (used GPU: 4391 MiB)
Epoch 19 - update      37710 => loss: 0.784 (used GPU: 4391 MiB)
Epoch 19 - update      37740 => loss: 0.291 (used GPU: 4391 MiB)
Epoch 19 - update      37770 => loss: 0.906 (used GPU: 4391 MiB)
Epoch 19 - update      37800 => loss: 0.992 (used GPU: 4391 MiB)
--> Epoch 19 finished with mean loss 0.62173
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.94 mins)   (1100 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.89 sec, Scoring: 0.38 sec (343 sent/sec)
Validation 19 -> LOSS = 1.12
Validation 19 -> MRR = 84.75
Validation 19 -> BLEU = 54.49, 77.6/60.5/48.3/38.9 (BP=1.000, ratio=1.005, hyp_len=34065, ref_len=33879)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.76 @ validation 15
--> Best BLEU so far: 54.49 @ validation 19
Starting Epoch 20
Epoch 20 - update      37830 => loss: 0.166 (used GPU: 4391 MiB)
Epoch 20 - update      37860 => loss: 0.408 (used GPU: 4391 MiB)
Epoch 20 - update      37890 => loss: 0.605 (used GPU: 4391 MiB)
Epoch 20 - update      37920 => loss: 0.655 (used GPU: 4391 MiB)
Epoch 20 - update      37950 => loss: 0.852 (used GPU: 4391 MiB)
Epoch 20 - update      37980 => loss: 0.316 (used GPU: 4391 MiB)
Epoch 20 - update      38010 => loss: 0.693 (used GPU: 4391 MiB)
Epoch 20 - update      38040 => loss: 0.664 (used GPU: 4391 MiB)
Epoch 20 - update      38070 => loss: 0.323 (used GPU: 4391 MiB)
Epoch 20 - update      38100 => loss: 0.256 (used GPU: 4391 MiB)
Epoch 20 - update      38130 => loss: 0.528 (used GPU: 4391 MiB)
Epoch 20 - update      38160 => loss: 0.289 (used GPU: 4391 MiB)
Epoch 20 - update      38190 => loss: 0.537 (used GPU: 4391 MiB)
Epoch 20 - update      38220 => loss: 0.392 (used GPU: 4391 MiB)
Epoch 20 - update      38250 => loss: 0.567 (used GPU: 4391 MiB)
Epoch 20 - update      38280 => loss: 0.305 (used GPU: 4391 MiB)
Epoch 20 - update      38310 => loss: 0.609 (used GPU: 4391 MiB)
Epoch 20 - update      38340 => loss: 0.622 (used GPU: 4391 MiB)
Epoch 20 - update      38370 => loss: 0.739 (used GPU: 4391 MiB)
Epoch 20 - update      38400 => loss: 0.773 (used GPU: 4391 MiB)
Epoch 20 - update      38430 => loss: 0.461 (used GPU: 4391 MiB)
Epoch 20 - update      38460 => loss: 0.244 (used GPU: 4391 MiB)
Epoch 20 - update      38490 => loss: 0.760 (used GPU: 4391 MiB)
Epoch 20 - update      38520 => loss: 0.344 (used GPU: 4391 MiB)
Epoch 20 - update      38550 => loss: 0.305 (used GPU: 4391 MiB)
Epoch 20 - update      38580 => loss: 0.713 (used GPU: 4391 MiB)
Epoch 20 - update      38610 => loss: 0.341 (used GPU: 4391 MiB)
Epoch 20 - update      38640 => loss: 0.798 (used GPU: 4391 MiB)
Epoch 20 - update      38670 => loss: 0.180 (used GPU: 4391 MiB)
Epoch 20 - update      38700 => loss: 0.692 (used GPU: 4391 MiB)
Epoch 20 - update      38730 => loss: 0.622 (used GPU: 4391 MiB)
Epoch 20 - update      38760 => loss: 0.460 (used GPU: 4391 MiB)
Epoch 20 - update      38790 => loss: 0.283 (used GPU: 4391 MiB)
Epoch 20 - update      38820 => loss: 0.681 (used GPU: 4391 MiB)
Epoch 20 - update      38850 => loss: 0.559 (used GPU: 4391 MiB)
Epoch 20 - update      38880 => loss: 0.459 (used GPU: 4391 MiB)
Epoch 20 - update      38910 => loss: 0.839 (used GPU: 4391 MiB)
Epoch 20 - update      38940 => loss: 0.585 (used GPU: 4391 MiB)
Epoch 20 - update      38970 => loss: 1.100 (used GPU: 4391 MiB)
Epoch 20 - update      39000 => loss: 0.210 (used GPU: 4391 MiB)
Epoch 20 - update      39030 => loss: 0.313 (used GPU: 4391 MiB)
Epoch 20 - update      39060 => loss: 0.553 (used GPU: 4391 MiB)
Epoch 20 - update      39090 => loss: 0.370 (used GPU: 4391 MiB)
Epoch 20 - update      39120 => loss: 0.224 (used GPU: 4391 MiB)
Epoch 20 - update      39150 => loss: 0.643 (used GPU: 4391 MiB)
Epoch 20 - update      39180 => loss: 0.724 (used GPU: 4391 MiB)
Epoch 20 - update      39210 => loss: 0.692 (used GPU: 4391 MiB)
Epoch 20 - update      39240 => loss: 0.593 (used GPU: 4391 MiB)
Epoch 20 - update      39270 => loss: 0.872 (used GPU: 4391 MiB)
Epoch 20 - update      39300 => loss: 0.462 (used GPU: 4391 MiB)
Epoch 20 - update      39330 => loss: 0.472 (used GPU: 4391 MiB)
Epoch 20 - update      39360 => loss: 0.554 (used GPU: 4391 MiB)
Epoch 20 - update      39390 => loss: 0.557 (used GPU: 4391 MiB)
Epoch 20 - update      39420 => loss: 0.549 (used GPU: 4391 MiB)
Epoch 20 - update      39450 => loss: 1.040 (used GPU: 4391 MiB)
Epoch 20 - update      39480 => loss: 0.245 (used GPU: 4391 MiB)
Epoch 20 - update      39510 => loss: 0.444 (used GPU: 4391 MiB)
Epoch 20 - update      39540 => loss: 0.451 (used GPU: 4391 MiB)
Epoch 20 - update      39570 => loss: 0.784 (used GPU: 4391 MiB)
Epoch 20 - update      39600 => loss: 0.194 (used GPU: 4391 MiB)
Epoch 20 - update      39630 => loss: 0.738 (used GPU: 4391 MiB)
Epoch 20 - update      39660 => loss: 0.350 (used GPU: 4391 MiB)
Epoch 20 - update      39690 => loss: 0.192 (used GPU: 4391 MiB)
Epoch 20 - update      39720 => loss: 0.310 (used GPU: 4391 MiB)
Epoch 20 - update      39750 => loss: 0.419 (used GPU: 4391 MiB)
Epoch 20 - update      39780 => loss: 0.481 (used GPU: 4391 MiB)
Epoch 20 - update      39810 => loss: 0.487 (used GPU: 4391 MiB)
--> Epoch 20 finished with mean loss 0.61806
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.94 mins)   (1101 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.92 sec, Scoring: 0.38 sec (341 sent/sec)
Validation 20 -> LOSS = 1.13
Validation 20 -> MRR = 84.77
Validation 20 -> BLEU = 53.92, 77.1/59.9/47.7/38.3 (BP=1.000, ratio=1.011, hyp_len=34262, ref_len=33879)
Early stopping patience: 9
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.77 @ validation 20
--> Best BLEU so far: 54.49 @ validation 19
Starting Epoch 21
Epoch 21 - update      39840 => loss: 0.273 (used GPU: 4391 MiB)
Epoch 21 - update      39870 => loss: 0.537 (used GPU: 4391 MiB)
Epoch 21 - update      39900 => loss: 0.720 (used GPU: 4391 MiB)
Epoch 21 - update      39930 => loss: 0.327 (used GPU: 4391 MiB)
Epoch 21 - update      39960 => loss: 0.147 (used GPU: 4391 MiB)
Epoch 21 - update      39990 => loss: 0.657 (used GPU: 4391 MiB)
Epoch 21 - update      40020 => loss: 0.305 (used GPU: 4391 MiB)
Epoch 21 - update      40050 => loss: 0.526 (used GPU: 4391 MiB)
Epoch 21 - update      40080 => loss: 0.365 (used GPU: 4391 MiB)
Epoch 21 - update      40110 => loss: 0.549 (used GPU: 4391 MiB)
Epoch 21 - update      40140 => loss: 0.579 (used GPU: 4391 MiB)
Epoch 21 - update      40170 => loss: 0.205 (used GPU: 4391 MiB)
Epoch 21 - update      40200 => loss: 0.175 (used GPU: 4391 MiB)
Epoch 21 - update      40230 => loss: 0.492 (used GPU: 4391 MiB)
Epoch 21 - update      40260 => loss: 0.752 (used GPU: 4391 MiB)
Epoch 21 - update      40290 => loss: 0.348 (used GPU: 4391 MiB)
Epoch 21 - update      40320 => loss: 0.846 (used GPU: 4391 MiB)
Epoch 21 - update      40350 => loss: 0.673 (used GPU: 4391 MiB)
Epoch 21 - update      40380 => loss: 0.885 (used GPU: 4391 MiB)
Epoch 21 - update      40410 => loss: 0.570 (used GPU: 4391 MiB)
Epoch 21 - update      40440 => loss: 1.113 (used GPU: 4391 MiB)
Epoch 21 - update      40470 => loss: 0.623 (used GPU: 4391 MiB)
Epoch 21 - update      40500 => loss: 0.381 (used GPU: 4391 MiB)
Epoch 21 - update      40530 => loss: 0.165 (used GPU: 4391 MiB)
Epoch 21 - update      40560 => loss: 0.640 (used GPU: 4391 MiB)
Epoch 21 - update      40590 => loss: 0.734 (used GPU: 4391 MiB)
Epoch 21 - update      40620 => loss: 0.394 (used GPU: 4391 MiB)
Epoch 21 - update      40650 => loss: 0.809 (used GPU: 4391 MiB)
Epoch 21 - update      40680 => loss: 0.414 (used GPU: 4391 MiB)
Epoch 21 - update      40710 => loss: 0.383 (used GPU: 4391 MiB)
Epoch 21 - update      40740 => loss: 0.220 (used GPU: 4391 MiB)
Epoch 21 - update      40770 => loss: 0.443 (used GPU: 4391 MiB)
Epoch 21 - update      40800 => loss: 0.329 (used GPU: 4391 MiB)
Epoch 21 - update      40830 => loss: 0.354 (used GPU: 4391 MiB)
Epoch 21 - update      40860 => loss: 0.179 (used GPU: 4391 MiB)
Epoch 21 - update      40890 => loss: 0.203 (used GPU: 4391 MiB)
Epoch 21 - update      40920 => loss: 0.958 (used GPU: 4391 MiB)
Epoch 21 - update      40950 => loss: 0.537 (used GPU: 4391 MiB)
Epoch 21 - update      40980 => loss: 0.146 (used GPU: 4391 MiB)
Epoch 21 - update      41010 => loss: 0.812 (used GPU: 4391 MiB)
Epoch 21 - update      41040 => loss: 0.536 (used GPU: 4391 MiB)
Epoch 21 - update      41070 => loss: 1.189 (used GPU: 4391 MiB)
Epoch 21 - update      41100 => loss: 0.669 (used GPU: 4391 MiB)
Epoch 21 - update      41130 => loss: 0.961 (used GPU: 4391 MiB)
Epoch 21 - update      41160 => loss: 0.615 (used GPU: 4391 MiB)
Epoch 21 - update      41190 => loss: 0.770 (used GPU: 4391 MiB)
Epoch 21 - update      41220 => loss: 0.353 (used GPU: 4391 MiB)
Epoch 21 - update      41250 => loss: 0.186 (used GPU: 4391 MiB)
Epoch 21 - update      41280 => loss: 0.268 (used GPU: 4391 MiB)
Epoch 21 - update      41310 => loss: 0.296 (used GPU: 4391 MiB)
Epoch 21 - update      41340 => loss: 0.430 (used GPU: 4391 MiB)
Epoch 21 - update      41370 => loss: 0.803 (used GPU: 4391 MiB)
Epoch 21 - update      41400 => loss: 0.509 (used GPU: 4391 MiB)
Epoch 21 - update      41430 => loss: 0.361 (used GPU: 4391 MiB)
Epoch 21 - update      41460 => loss: 0.184 (used GPU: 4391 MiB)
Epoch 21 - update      41490 => loss: 0.186 (used GPU: 4391 MiB)
Epoch 21 - update      41520 => loss: 0.163 (used GPU: 4391 MiB)
Epoch 21 - update      41550 => loss: 1.250 (used GPU: 4391 MiB)
Epoch 21 - update      41580 => loss: 0.601 (used GPU: 4391 MiB)
Epoch 21 - update      41610 => loss: 0.748 (used GPU: 4391 MiB)
Epoch 21 - update      41640 => loss: 0.425 (used GPU: 4391 MiB)
Epoch 21 - update      41670 => loss: 0.603 (used GPU: 4391 MiB)
Epoch 21 - update      41700 => loss: 0.800 (used GPU: 4391 MiB)
Epoch 21 - update      41730 => loss: 0.218 (used GPU: 4391 MiB)
Epoch 21 - update      41760 => loss: 0.618 (used GPU: 4391 MiB)
Epoch 21 - update      41790 => loss: 0.859 (used GPU: 4391 MiB)
--> Epoch 21 finished with mean loss 0.61446
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.94 mins)   (1101 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.91 sec, Scoring: 0.38 sec (341 sent/sec)
Validation 21 -> LOSS = 1.12
Validation 21 -> MRR = 84.74
Validation 21 -> BLEU = 53.73, 76.9/59.7/47.6/38.2 (BP=1.000, ratio=1.014, hyp_len=34355, ref_len=33879)
Early stopping patience: 8
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.77 @ validation 20
--> Best BLEU so far: 54.49 @ validation 19
Starting Epoch 22
Epoch 22 - update      41820 => loss: 0.194 (used GPU: 4391 MiB)
Epoch 22 - update      41850 => loss: 0.758 (used GPU: 4391 MiB)
Epoch 22 - update      41880 => loss: 0.539 (used GPU: 4391 MiB)
Epoch 22 - update      41910 => loss: 0.462 (used GPU: 4391 MiB)
Epoch 22 - update      41940 => loss: 0.463 (used GPU: 4391 MiB)
Epoch 22 - update      41970 => loss: 0.227 (used GPU: 4391 MiB)
Epoch 22 - update      42000 => loss: 0.513 (used GPU: 4391 MiB)
Epoch 22 - update      42030 => loss: 0.145 (used GPU: 4391 MiB)
Epoch 22 - update      42060 => loss: 0.298 (used GPU: 4391 MiB)
Epoch 22 - update      42090 => loss: 0.510 (used GPU: 4391 MiB)
Epoch 22 - update      42120 => loss: 0.405 (used GPU: 4391 MiB)
Epoch 22 - update      42150 => loss: 0.328 (used GPU: 4391 MiB)
Epoch 22 - update      42180 => loss: 0.526 (used GPU: 4391 MiB)
Epoch 22 - update      42210 => loss: 0.382 (used GPU: 4391 MiB)
Epoch 22 - update      42240 => loss: 0.606 (used GPU: 4391 MiB)
Epoch 22 - update      42270 => loss: 0.746 (used GPU: 4391 MiB)
Epoch 22 - update      42300 => loss: 0.448 (used GPU: 4391 MiB)
Epoch 22 - update      42330 => loss: 0.540 (used GPU: 4391 MiB)
Epoch 22 - update      42360 => loss: 0.219 (used GPU: 4391 MiB)
Epoch 22 - update      42390 => loss: 0.439 (used GPU: 4391 MiB)
Epoch 22 - update      42420 => loss: 0.679 (used GPU: 4391 MiB)
Epoch 22 - update      42450 => loss: 0.278 (used GPU: 4391 MiB)
Epoch 22 - update      42480 => loss: 0.169 (used GPU: 4391 MiB)
Epoch 22 - update      42510 => loss: 0.439 (used GPU: 4391 MiB)
Epoch 22 - update      42540 => loss: 0.633 (used GPU: 4391 MiB)
Epoch 22 - update      42570 => loss: 0.913 (used GPU: 4391 MiB)
Epoch 22 - update      42600 => loss: 0.600 (used GPU: 4391 MiB)
Epoch 22 - update      42630 => loss: 0.176 (used GPU: 4391 MiB)
Epoch 22 - update      42660 => loss: 0.638 (used GPU: 4391 MiB)
Epoch 22 - update      42690 => loss: 0.706 (used GPU: 4391 MiB)
Epoch 22 - update      42720 => loss: 0.387 (used GPU: 4391 MiB)
Epoch 22 - update      42750 => loss: 0.372 (used GPU: 4391 MiB)
Epoch 22 - update      42780 => loss: 0.238 (used GPU: 4391 MiB)
Epoch 22 - update      42810 => loss: 1.187 (used GPU: 4391 MiB)
Epoch 22 - update      42840 => loss: 0.700 (used GPU: 4391 MiB)
Epoch 22 - update      42870 => loss: 0.676 (used GPU: 4391 MiB)
Epoch 22 - update      42900 => loss: 0.840 (used GPU: 4391 MiB)
Epoch 22 - update      42930 => loss: 0.524 (used GPU: 4391 MiB)
Epoch 22 - update      42960 => loss: 0.556 (used GPU: 4391 MiB)
Epoch 22 - update      42990 => loss: 0.213 (used GPU: 4391 MiB)
Epoch 22 - update      43020 => loss: 0.526 (used GPU: 4391 MiB)
Epoch 22 - update      43050 => loss: 0.589 (used GPU: 4391 MiB)
Epoch 22 - update      43080 => loss: 0.508 (used GPU: 4391 MiB)
Epoch 22 - update      43110 => loss: 0.339 (used GPU: 4391 MiB)
Epoch 22 - update      43140 => loss: 0.434 (used GPU: 4391 MiB)
Epoch 22 - update      43170 => loss: 0.686 (used GPU: 4391 MiB)
Epoch 22 - update      43200 => loss: 0.382 (used GPU: 4391 MiB)
Epoch 22 - update      43230 => loss: 0.316 (used GPU: 4391 MiB)
Epoch 22 - update      43260 => loss: 0.216 (used GPU: 4391 MiB)
Epoch 22 - update      43290 => loss: 0.427 (used GPU: 4391 MiB)
Epoch 22 - update      43320 => loss: 0.417 (used GPU: 4391 MiB)
Epoch 22 - update      43350 => loss: 0.470 (used GPU: 4391 MiB)
Epoch 22 - update      43380 => loss: 0.751 (used GPU: 4391 MiB)
Epoch 22 - update      43410 => loss: 0.500 (used GPU: 4391 MiB)
Epoch 22 - update      43440 => loss: 0.390 (used GPU: 4391 MiB)
Epoch 22 - update      43470 => loss: 1.068 (used GPU: 4391 MiB)
Epoch 22 - update      43500 => loss: 0.422 (used GPU: 4391 MiB)
Epoch 22 - update      43530 => loss: 0.572 (used GPU: 4391 MiB)
Epoch 22 - update      43560 => loss: 0.197 (used GPU: 4391 MiB)
Epoch 22 - update      43590 => loss: 0.466 (used GPU: 4391 MiB)
Epoch 22 - update      43620 => loss: 0.383 (used GPU: 4391 MiB)
Epoch 22 - update      43650 => loss: 0.290 (used GPU: 4391 MiB)
Epoch 22 - update      43680 => loss: 0.777 (used GPU: 4391 MiB)
Epoch 22 - update      43710 => loss: 0.407 (used GPU: 4391 MiB)
Epoch 22 - update      43740 => loss: 1.002 (used GPU: 4391 MiB)
Epoch 22 - update      43770 => loss: 0.659 (used GPU: 4391 MiB)
Epoch 22 - update      43800 => loss: 0.447 (used GPU: 4391 MiB)
--> Epoch 22 finished with mean loss 0.61167
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.94 mins)   (1100 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.88 sec, Scoring: 0.38 sec (344 sent/sec)
Validation 22 -> LOSS = 1.12
Validation 22 -> MRR = 84.60
Validation 22 -> BLEU = 53.83, 77.1/59.8/47.7/38.2 (BP=1.000, ratio=1.006, hyp_len=34099, ref_len=33879)
** Learning rate changed -> 0.0001
Early stopping patience: 7
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.77 @ validation 20
--> Best BLEU so far: 54.49 @ validation 19
Starting Epoch 23
Epoch 23 - update      43830 => loss: 0.284 (used GPU: 4391 MiB)
Epoch 23 - update      43860 => loss: 0.239 (used GPU: 4391 MiB)
Epoch 23 - update      43890 => loss: 0.522 (used GPU: 4391 MiB)
Epoch 23 - update      43920 => loss: 0.560 (used GPU: 4391 MiB)
Epoch 23 - update      43950 => loss: 0.480 (used GPU: 4391 MiB)
Epoch 23 - update      43980 => loss: 0.438 (used GPU: 4391 MiB)
Epoch 23 - update      44010 => loss: 0.180 (used GPU: 4391 MiB)
Epoch 23 - update      44040 => loss: 0.336 (used GPU: 4391 MiB)
Epoch 23 - update      44070 => loss: 0.626 (used GPU: 4391 MiB)
Epoch 23 - update      44100 => loss: 0.291 (used GPU: 4391 MiB)
Epoch 23 - update      44130 => loss: 0.637 (used GPU: 4391 MiB)
Epoch 23 - update      44160 => loss: 0.642 (used GPU: 4391 MiB)
Epoch 23 - update      44190 => loss: 0.592 (used GPU: 4391 MiB)
Epoch 23 - update      44220 => loss: 0.398 (used GPU: 4391 MiB)
Epoch 23 - update      44250 => loss: 0.422 (used GPU: 4391 MiB)
Epoch 23 - update      44280 => loss: 0.527 (used GPU: 4391 MiB)
Epoch 23 - update      44310 => loss: 0.684 (used GPU: 4391 MiB)
Epoch 23 - update      44340 => loss: 0.545 (used GPU: 4391 MiB)
Epoch 23 - update      44370 => loss: 0.336 (used GPU: 4391 MiB)
Epoch 23 - update      44400 => loss: 0.489 (used GPU: 4391 MiB)
Epoch 23 - update      44430 => loss: 0.589 (used GPU: 4391 MiB)
Epoch 23 - update      44460 => loss: 0.648 (used GPU: 4391 MiB)
Epoch 23 - update      44490 => loss: 0.450 (used GPU: 4391 MiB)
Epoch 23 - update      44520 => loss: 0.372 (used GPU: 4391 MiB)
Epoch 23 - update      44550 => loss: 0.831 (used GPU: 4391 MiB)
Epoch 23 - update      44580 => loss: 0.631 (used GPU: 4391 MiB)
Epoch 23 - update      44610 => loss: 0.843 (used GPU: 4391 MiB)
Epoch 23 - update      44640 => loss: 0.415 (used GPU: 4391 MiB)
Epoch 23 - update      44670 => loss: 0.689 (used GPU: 4391 MiB)
Epoch 23 - update      44700 => loss: 0.442 (used GPU: 4391 MiB)
Epoch 23 - update      44730 => loss: 0.153 (used GPU: 4391 MiB)
Epoch 23 - update      44760 => loss: 0.230 (used GPU: 4391 MiB)
Epoch 23 - update      44790 => loss: 0.159 (used GPU: 4391 MiB)
Epoch 23 - update      44820 => loss: 0.222 (used GPU: 4391 MiB)
Epoch 23 - update      44850 => loss: 0.522 (used GPU: 4391 MiB)
Epoch 23 - update      44880 => loss: 0.677 (used GPU: 4391 MiB)
Epoch 23 - update      44910 => loss: 0.741 (used GPU: 4391 MiB)
Epoch 23 - update      44940 => loss: 0.462 (used GPU: 4391 MiB)
Epoch 23 - update      44970 => loss: 0.438 (used GPU: 4391 MiB)
Epoch 23 - update      45000 => loss: 0.323 (used GPU: 4391 MiB)
Epoch 23 - update      45030 => loss: 0.347 (used GPU: 4391 MiB)
Epoch 23 - update      45060 => loss: 0.739 (used GPU: 4391 MiB)
Epoch 23 - update      45090 => loss: 0.663 (used GPU: 4391 MiB)
Epoch 23 - update      45120 => loss: 0.272 (used GPU: 4391 MiB)
Epoch 23 - update      45150 => loss: 0.261 (used GPU: 4391 MiB)
Epoch 23 - update      45180 => loss: 0.317 (used GPU: 4391 MiB)
Epoch 23 - update      45210 => loss: 0.537 (used GPU: 4391 MiB)
Epoch 23 - update      45240 => loss: 0.134 (used GPU: 4391 MiB)
Epoch 23 - update      45270 => loss: 0.776 (used GPU: 4391 MiB)
Epoch 23 - update      45300 => loss: 0.653 (used GPU: 4391 MiB)
Epoch 23 - update      45330 => loss: 0.375 (used GPU: 4391 MiB)
Epoch 23 - update      45360 => loss: 0.806 (used GPU: 4391 MiB)
Epoch 23 - update      45390 => loss: 0.760 (used GPU: 4391 MiB)
Epoch 23 - update      45420 => loss: 0.156 (used GPU: 4391 MiB)
Epoch 23 - update      45450 => loss: 0.567 (used GPU: 4391 MiB)
Epoch 23 - update      45480 => loss: 0.408 (used GPU: 4391 MiB)
Epoch 23 - update      45510 => loss: 0.328 (used GPU: 4391 MiB)
Epoch 23 - update      45540 => loss: 0.131 (used GPU: 4391 MiB)
Epoch 23 - update      45570 => loss: 0.234 (used GPU: 4391 MiB)
Epoch 23 - update      45600 => loss: 0.343 (used GPU: 4391 MiB)
Epoch 23 - update      45630 => loss: 0.674 (used GPU: 4391 MiB)
Epoch 23 - update      45660 => loss: 0.790 (used GPU: 4391 MiB)
Epoch 23 - update      45690 => loss: 0.606 (used GPU: 4391 MiB)
Epoch 23 - update      45720 => loss: 0.509 (used GPU: 4391 MiB)
Epoch 23 - update      45750 => loss: 0.300 (used GPU: 4391 MiB)
Epoch 23 - update      45780 => loss: 0.234 (used GPU: 4391 MiB)
--> Epoch 23 finished with mean loss 0.57804
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.93 mins)   (1102 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.94 sec, Scoring: 0.38 sec (340 sent/sec)
Validation 23 -> LOSS = 1.12
Validation 23 -> MRR = 84.84
Validation 23 -> BLEU = 54.21, 77.2/60.1/48.1/38.7 (BP=1.000, ratio=1.012, hyp_len=34270, ref_len=33879)
Early stopping patience: 6
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.84 @ validation 23
--> Best BLEU so far: 54.49 @ validation 19
Starting Epoch 24
Epoch 24 - update      45810 => loss: 0.794 (used GPU: 4391 MiB)
Epoch 24 - update      45840 => loss: 0.235 (used GPU: 4391 MiB)
Epoch 24 - update      45870 => loss: 0.315 (used GPU: 4391 MiB)
Epoch 24 - update      45900 => loss: 0.164 (used GPU: 4391 MiB)
Epoch 24 - update      45930 => loss: 0.605 (used GPU: 4391 MiB)
Epoch 24 - update      45960 => loss: 0.652 (used GPU: 4391 MiB)
Epoch 24 - update      45990 => loss: 0.457 (used GPU: 4391 MiB)
Epoch 24 - update      46020 => loss: 0.608 (used GPU: 4391 MiB)
Epoch 24 - update      46050 => loss: 0.797 (used GPU: 4391 MiB)
Epoch 24 - update      46080 => loss: 0.239 (used GPU: 4391 MiB)
Epoch 24 - update      46110 => loss: 0.273 (used GPU: 4391 MiB)
Epoch 24 - update      46140 => loss: 0.687 (used GPU: 4391 MiB)
Epoch 24 - update      46170 => loss: 0.149 (used GPU: 4391 MiB)
Epoch 24 - update      46200 => loss: 0.356 (used GPU: 4391 MiB)
Epoch 24 - update      46230 => loss: 0.300 (used GPU: 4391 MiB)
Epoch 24 - update      46260 => loss: 0.510 (used GPU: 4391 MiB)
Epoch 24 - update      46290 => loss: 0.561 (used GPU: 4391 MiB)
Epoch 24 - update      46320 => loss: 0.646 (used GPU: 4391 MiB)
Epoch 24 - update      46350 => loss: 0.649 (used GPU: 4391 MiB)
Epoch 24 - update      46380 => loss: 0.679 (used GPU: 4391 MiB)
Epoch 24 - update      46410 => loss: 0.628 (used GPU: 4391 MiB)
Epoch 24 - update      46440 => loss: 0.745 (used GPU: 4391 MiB)
Epoch 24 - update      46470 => loss: 0.172 (used GPU: 4391 MiB)
Epoch 24 - update      46500 => loss: 0.172 (used GPU: 4391 MiB)
Epoch 24 - update      46530 => loss: 0.305 (used GPU: 4391 MiB)
Epoch 24 - update      46560 => loss: 0.181 (used GPU: 4391 MiB)
Epoch 24 - update      46590 => loss: 0.671 (used GPU: 4391 MiB)
Epoch 24 - update      46620 => loss: 0.814 (used GPU: 4391 MiB)
Epoch 24 - update      46650 => loss: 0.456 (used GPU: 4391 MiB)
Epoch 24 - update      46680 => loss: 0.263 (used GPU: 4391 MiB)
Epoch 24 - update      46710 => loss: 0.803 (used GPU: 4391 MiB)
Epoch 24 - update      46740 => loss: 0.168 (used GPU: 4391 MiB)
Epoch 24 - update      46770 => loss: 0.342 (used GPU: 4391 MiB)
Epoch 24 - update      46800 => loss: 0.450 (used GPU: 4391 MiB)
Epoch 24 - update      46830 => loss: 0.539 (used GPU: 4391 MiB)
Epoch 24 - update      46860 => loss: 0.282 (used GPU: 4391 MiB)
Epoch 24 - update      46890 => loss: 0.787 (used GPU: 4391 MiB)
Epoch 24 - update      46920 => loss: 0.442 (used GPU: 4391 MiB)
Epoch 24 - update      46950 => loss: 0.173 (used GPU: 4391 MiB)
Epoch 24 - update      46980 => loss: 0.314 (used GPU: 4391 MiB)
Epoch 24 - update      47010 => loss: 0.456 (used GPU: 4391 MiB)
Epoch 24 - update      47040 => loss: 0.157 (used GPU: 4391 MiB)
Epoch 24 - update      47070 => loss: 0.465 (used GPU: 4391 MiB)
Epoch 24 - update      47100 => loss: 0.953 (used GPU: 4391 MiB)
Epoch 24 - update      47130 => loss: 0.725 (used GPU: 4391 MiB)
Epoch 24 - update      47160 => loss: 0.171 (used GPU: 4391 MiB)
Epoch 24 - update      47190 => loss: 0.701 (used GPU: 4391 MiB)
Epoch 24 - update      47220 => loss: 1.010 (used GPU: 4391 MiB)
Epoch 24 - update      47250 => loss: 0.744 (used GPU: 4391 MiB)
Epoch 24 - update      47280 => loss: 0.862 (used GPU: 4391 MiB)
Epoch 24 - update      47310 => loss: 0.382 (used GPU: 4391 MiB)
Epoch 24 - update      47340 => loss: 0.682 (used GPU: 4391 MiB)
Epoch 24 - update      47370 => loss: 0.530 (used GPU: 4391 MiB)
Epoch 24 - update      47400 => loss: 0.236 (used GPU: 4391 MiB)
Epoch 24 - update      47430 => loss: 0.784 (used GPU: 4391 MiB)
Epoch 24 - update      47460 => loss: 0.402 (used GPU: 4391 MiB)
Epoch 24 - update      47490 => loss: 0.207 (used GPU: 4391 MiB)
Epoch 24 - update      47520 => loss: 0.706 (used GPU: 4391 MiB)
Epoch 24 - update      47550 => loss: 0.682 (used GPU: 4391 MiB)
Epoch 24 - update      47580 => loss: 0.497 (used GPU: 4391 MiB)
Epoch 24 - update      47610 => loss: 0.154 (used GPU: 4391 MiB)
Epoch 24 - update      47640 => loss: 0.579 (used GPU: 4391 MiB)
Epoch 24 - update      47670 => loss: 0.191 (used GPU: 4391 MiB)
Epoch 24 - update      47700 => loss: 0.291 (used GPU: 4391 MiB)
Epoch 24 - update      47730 => loss: 0.406 (used GPU: 4391 MiB)
Epoch 24 - update      47760 => loss: 0.264 (used GPU: 4391 MiB)
--> Epoch 24 finished with mean loss 0.56919
--> Overhead/Training/Evaluation: 0.16/2.80/0.00 mins (total: 2.95 mins)   (1103 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.94 sec, Scoring: 0.38 sec (340 sent/sec)
Validation 24 -> LOSS = 1.12
Validation 24 -> MRR = 84.82
Validation 24 -> BLEU = 53.99, 77.1/60.0/47.9/38.4 (BP=1.000, ratio=1.012, hyp_len=34274, ref_len=33879)
Early stopping patience: 5
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.84 @ validation 23
--> Best BLEU so far: 54.49 @ validation 19
Starting Epoch 25
Epoch 25 - update      47790 => loss: 0.489 (used GPU: 4391 MiB)
Epoch 25 - update      47820 => loss: 0.919 (used GPU: 4391 MiB)
Epoch 25 - update      47850 => loss: 0.422 (used GPU: 4391 MiB)
Epoch 25 - update      47880 => loss: 0.185 (used GPU: 4391 MiB)
Epoch 25 - update      47910 => loss: 0.365 (used GPU: 4391 MiB)
Epoch 25 - update      47940 => loss: 0.664 (used GPU: 4391 MiB)
Epoch 25 - update      47970 => loss: 0.449 (used GPU: 4391 MiB)
Epoch 25 - update      48000 => loss: 0.496 (used GPU: 4391 MiB)
Epoch 25 - update      48030 => loss: 0.242 (used GPU: 4391 MiB)
Epoch 25 - update      48060 => loss: 0.651 (used GPU: 4391 MiB)
Epoch 25 - update      48090 => loss: 0.468 (used GPU: 4391 MiB)
Epoch 25 - update      48120 => loss: 0.732 (used GPU: 4391 MiB)
Epoch 25 - update      48150 => loss: 0.799 (used GPU: 4391 MiB)
Epoch 25 - update      48180 => loss: 0.395 (used GPU: 4391 MiB)
Epoch 25 - update      48210 => loss: 0.145 (used GPU: 4391 MiB)
Epoch 25 - update      48240 => loss: 0.497 (used GPU: 4391 MiB)
Epoch 25 - update      48270 => loss: 0.401 (used GPU: 4391 MiB)
Epoch 25 - update      48300 => loss: 0.366 (used GPU: 4391 MiB)
Epoch 25 - update      48330 => loss: 0.600 (used GPU: 4391 MiB)
Epoch 25 - update      48360 => loss: 0.200 (used GPU: 4391 MiB)
Epoch 25 - update      48390 => loss: 0.423 (used GPU: 4391 MiB)
Epoch 25 - update      48420 => loss: 0.420 (used GPU: 4391 MiB)
Epoch 25 - update      48450 => loss: 0.485 (used GPU: 4391 MiB)
Epoch 25 - update      48480 => loss: 0.911 (used GPU: 4391 MiB)
Epoch 25 - update      48510 => loss: 0.509 (used GPU: 4391 MiB)
Epoch 25 - update      48540 => loss: 0.672 (used GPU: 4391 MiB)
Epoch 25 - update      48570 => loss: 0.530 (used GPU: 4391 MiB)
Epoch 25 - update      48600 => loss: 0.356 (used GPU: 4391 MiB)
Epoch 25 - update      48630 => loss: 0.368 (used GPU: 4391 MiB)
Epoch 25 - update      48660 => loss: 0.444 (used GPU: 4391 MiB)
Epoch 25 - update      48690 => loss: 0.598 (used GPU: 4391 MiB)
Epoch 25 - update      48720 => loss: 0.462 (used GPU: 4391 MiB)
Epoch 25 - update      48750 => loss: 0.837 (used GPU: 4391 MiB)
Epoch 25 - update      48780 => loss: 0.142 (used GPU: 4391 MiB)
Epoch 25 - update      48810 => loss: 0.531 (used GPU: 4391 MiB)
Epoch 25 - update      48840 => loss: 0.433 (used GPU: 4391 MiB)
Epoch 25 - update      48870 => loss: 0.203 (used GPU: 4391 MiB)
Epoch 25 - update      48900 => loss: 0.171 (used GPU: 4391 MiB)
Epoch 25 - update      48930 => loss: 0.149 (used GPU: 4391 MiB)
Epoch 25 - update      48960 => loss: 0.458 (used GPU: 4391 MiB)
Epoch 25 - update      48990 => loss: 0.686 (used GPU: 4391 MiB)
Epoch 25 - update      49020 => loss: 0.541 (used GPU: 4391 MiB)
Epoch 25 - update      49050 => loss: 0.829 (used GPU: 4391 MiB)
Epoch 25 - update      49080 => loss: 0.291 (used GPU: 4391 MiB)
Epoch 25 - update      49110 => loss: 0.255 (used GPU: 4391 MiB)
Epoch 25 - update      49140 => loss: 0.779 (used GPU: 4391 MiB)
Epoch 25 - update      49170 => loss: 0.748 (used GPU: 4391 MiB)
Epoch 25 - update      49200 => loss: 0.754 (used GPU: 4391 MiB)
Epoch 25 - update      49230 => loss: 0.606 (used GPU: 4391 MiB)
Epoch 25 - update      49260 => loss: 0.462 (used GPU: 4391 MiB)
Epoch 25 - update      49290 => loss: 0.192 (used GPU: 4391 MiB)
Epoch 25 - update      49320 => loss: 0.185 (used GPU: 4391 MiB)
Epoch 25 - update      49350 => loss: 0.432 (used GPU: 4391 MiB)
Epoch 25 - update      49380 => loss: 0.729 (used GPU: 4391 MiB)
Epoch 25 - update      49410 => loss: 0.566 (used GPU: 4391 MiB)
Epoch 25 - update      49440 => loss: 0.531 (used GPU: 4391 MiB)
Epoch 25 - update      49470 => loss: 0.346 (used GPU: 4391 MiB)
Epoch 25 - update      49500 => loss: 0.184 (used GPU: 4391 MiB)
Epoch 25 - update      49530 => loss: 0.401 (used GPU: 4391 MiB)
Epoch 25 - update      49560 => loss: 0.300 (used GPU: 4391 MiB)
Epoch 25 - update      49590 => loss: 0.473 (used GPU: 4391 MiB)
Epoch 25 - update      49620 => loss: 0.269 (used GPU: 4391 MiB)
Epoch 25 - update      49650 => loss: 0.372 (used GPU: 4391 MiB)
Epoch 25 - update      49680 => loss: 0.649 (used GPU: 4391 MiB)
Epoch 25 - update      49710 => loss: 0.961 (used GPU: 4391 MiB)
Epoch 25 - update      49740 => loss: 0.356 (used GPU: 4391 MiB)
Epoch 25 - update      49770 => loss: 0.286 (used GPU: 4391 MiB)
--> Epoch 25 finished with mean loss 0.56466
--> Overhead/Training/Evaluation: 0.14/2.81/0.00 mins (total: 2.95 mins)   (1099 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 6.00 sec, Scoring: 0.38 sec (336 sent/sec)
Validation 25 -> LOSS = 1.12
Validation 25 -> MRR = 84.87
Validation 25 -> BLEU = 54.31, 77.3/60.2/48.2/38.8 (BP=1.000, ratio=1.012, hyp_len=34285, ref_len=33879)
** Learning rate changed -> 5e-05
Early stopping patience: 4
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.87 @ validation 25
--> Best BLEU so far: 54.49 @ validation 19
Starting Epoch 26
Epoch 26 - update      49800 => loss: 0.877 (used GPU: 4391 MiB)
Epoch 26 - update      49830 => loss: 0.383 (used GPU: 4391 MiB)
Epoch 26 - update      49860 => loss: 0.797 (used GPU: 4391 MiB)
Epoch 26 - update      49890 => loss: 0.134 (used GPU: 4391 MiB)
Epoch 26 - update      49920 => loss: 0.436 (used GPU: 4391 MiB)
Epoch 26 - update      49950 => loss: 0.594 (used GPU: 4391 MiB)
Epoch 26 - update      49980 => loss: 0.510 (used GPU: 4391 MiB)
Epoch 26 - update      50010 => loss: 0.855 (used GPU: 4391 MiB)
Epoch 26 - update      50040 => loss: 0.782 (used GPU: 4391 MiB)
Epoch 26 - update      50070 => loss: 0.290 (used GPU: 4391 MiB)
Epoch 26 - update      50100 => loss: 0.372 (used GPU: 4391 MiB)
Epoch 26 - update      50130 => loss: 0.735 (used GPU: 4391 MiB)
Epoch 26 - update      50160 => loss: 0.317 (used GPU: 4391 MiB)
Epoch 26 - update      50190 => loss: 0.380 (used GPU: 4391 MiB)
Epoch 26 - update      50220 => loss: 0.317 (used GPU: 4391 MiB)
Epoch 26 - update      50250 => loss: 0.216 (used GPU: 4391 MiB)
Epoch 26 - update      50280 => loss: 0.342 (used GPU: 4391 MiB)
Epoch 26 - update      50310 => loss: 0.653 (used GPU: 4391 MiB)
Epoch 26 - update      50340 => loss: 0.283 (used GPU: 4391 MiB)
Epoch 26 - update      50370 => loss: 0.383 (used GPU: 4391 MiB)
Epoch 26 - update      50400 => loss: 0.515 (used GPU: 4391 MiB)
Epoch 26 - update      50430 => loss: 0.152 (used GPU: 4391 MiB)
Epoch 26 - update      50460 => loss: 0.363 (used GPU: 4391 MiB)
Epoch 26 - update      50490 => loss: 0.691 (used GPU: 4391 MiB)
Epoch 26 - update      50520 => loss: 0.880 (used GPU: 4391 MiB)
Epoch 26 - update      50550 => loss: 0.451 (used GPU: 4391 MiB)
Epoch 26 - update      50580 => loss: 0.629 (used GPU: 4391 MiB)
Epoch 26 - update      50610 => loss: 0.142 (used GPU: 4391 MiB)
Epoch 26 - update      50640 => loss: 0.480 (used GPU: 4391 MiB)
Epoch 26 - update      50670 => loss: 0.104 (used GPU: 4391 MiB)
Epoch 26 - update      50700 => loss: 0.664 (used GPU: 4391 MiB)
Epoch 26 - update      50730 => loss: 0.834 (used GPU: 4391 MiB)
Epoch 26 - update      50760 => loss: 0.648 (used GPU: 4391 MiB)
Epoch 26 - update      50790 => loss: 0.802 (used GPU: 4391 MiB)
Epoch 26 - update      50820 => loss: 0.300 (used GPU: 4391 MiB)
Epoch 26 - update      50850 => loss: 1.049 (used GPU: 4391 MiB)
Epoch 26 - update      50880 => loss: 0.296 (used GPU: 4391 MiB)
Epoch 26 - update      50910 => loss: 0.644 (used GPU: 4391 MiB)
Epoch 26 - update      50940 => loss: 0.563 (used GPU: 4391 MiB)
Epoch 26 - update      50970 => loss: 0.916 (used GPU: 4391 MiB)
Epoch 26 - update      51000 => loss: 0.666 (used GPU: 4391 MiB)
Epoch 26 - update      51030 => loss: 0.150 (used GPU: 4391 MiB)
Epoch 26 - update      51060 => loss: 0.639 (used GPU: 4391 MiB)
Epoch 26 - update      51090 => loss: 0.512 (used GPU: 4391 MiB)
Epoch 26 - update      51120 => loss: 0.561 (used GPU: 4391 MiB)
Epoch 26 - update      51150 => loss: 0.156 (used GPU: 4391 MiB)
Epoch 26 - update      51180 => loss: 0.151 (used GPU: 4391 MiB)
Epoch 26 - update      51210 => loss: 0.399 (used GPU: 4391 MiB)
Epoch 26 - update      51240 => loss: 0.453 (used GPU: 4391 MiB)
Epoch 26 - update      51270 => loss: 0.812 (used GPU: 4391 MiB)
Epoch 26 - update      51300 => loss: 0.732 (used GPU: 4391 MiB)
Epoch 26 - update      51330 => loss: 0.417 (used GPU: 4391 MiB)
Epoch 26 - update      51360 => loss: 0.256 (used GPU: 4391 MiB)
Epoch 26 - update      51390 => loss: 0.360 (used GPU: 4391 MiB)
Epoch 26 - update      51420 => loss: 0.759 (used GPU: 4391 MiB)
Epoch 26 - update      51450 => loss: 0.461 (used GPU: 4391 MiB)
Epoch 26 - update      51480 => loss: 0.150 (used GPU: 4391 MiB)
Epoch 26 - update      51510 => loss: 0.596 (used GPU: 4391 MiB)
Epoch 26 - update      51540 => loss: 0.437 (used GPU: 4391 MiB)
Epoch 26 - update      51570 => loss: 0.359 (used GPU: 4391 MiB)
Epoch 26 - update      51600 => loss: 0.448 (used GPU: 4391 MiB)
Epoch 26 - update      51630 => loss: 0.515 (used GPU: 4391 MiB)
Epoch 26 - update      51660 => loss: 0.187 (used GPU: 4391 MiB)
Epoch 26 - update      51690 => loss: 0.182 (used GPU: 4391 MiB)
Epoch 26 - update      51720 => loss: 0.838 (used GPU: 4391 MiB)
Epoch 26 - update      51750 => loss: 0.563 (used GPU: 4391 MiB)
--> Epoch 26 finished with mean loss 0.54757
--> Overhead/Training/Evaluation: 0.14/2.81/0.00 mins (total: 2.94 mins)   (1100 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.96 sec, Scoring: 0.38 sec (339 sent/sec)
Validation 26 -> LOSS = 1.12
Validation 26 -> MRR = 84.92
Validation 26 -> BLEU = 54.28, 77.2/60.2/48.2/38.7 (BP=1.000, ratio=1.011, hyp_len=34265, ref_len=33879)
Early stopping patience: 3
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.92 @ validation 26
--> Best BLEU so far: 54.49 @ validation 19
Starting Epoch 27
Epoch 27 - update      51780 => loss: 0.540 (used GPU: 4391 MiB)
Epoch 27 - update      51810 => loss: 0.637 (used GPU: 4391 MiB)
Epoch 27 - update      51840 => loss: 0.625 (used GPU: 4391 MiB)
Epoch 27 - update      51870 => loss: 0.297 (used GPU: 4391 MiB)
Epoch 27 - update      51900 => loss: 0.810 (used GPU: 4391 MiB)
Epoch 27 - update      51930 => loss: 0.331 (used GPU: 4391 MiB)
Epoch 27 - update      51960 => loss: 0.245 (used GPU: 4391 MiB)
Epoch 27 - update      51990 => loss: 0.271 (used GPU: 4391 MiB)
Epoch 27 - update      52020 => loss: 0.352 (used GPU: 4391 MiB)
Epoch 27 - update      52050 => loss: 0.551 (used GPU: 4391 MiB)
Epoch 27 - update      52080 => loss: 0.785 (used GPU: 4391 MiB)
Epoch 27 - update      52110 => loss: 0.897 (used GPU: 4391 MiB)
Epoch 27 - update      52140 => loss: 0.194 (used GPU: 4391 MiB)
Epoch 27 - update      52170 => loss: 0.152 (used GPU: 4391 MiB)
Epoch 27 - update      52200 => loss: 0.600 (used GPU: 4391 MiB)
Epoch 27 - update      52230 => loss: 0.617 (used GPU: 4391 MiB)
Epoch 27 - update      52260 => loss: 0.118 (used GPU: 4391 MiB)
Epoch 27 - update      52290 => loss: 0.285 (used GPU: 4391 MiB)
Epoch 27 - update      52320 => loss: 0.529 (used GPU: 4391 MiB)
Epoch 27 - update      52350 => loss: 0.734 (used GPU: 4391 MiB)
Epoch 27 - update      52380 => loss: 0.404 (used GPU: 4391 MiB)
Epoch 27 - update      52410 => loss: 0.343 (used GPU: 4391 MiB)
Epoch 27 - update      52440 => loss: 0.577 (used GPU: 4391 MiB)
Epoch 27 - update      52470 => loss: 0.285 (used GPU: 4391 MiB)
Epoch 27 - update      52500 => loss: 0.342 (used GPU: 4391 MiB)
Epoch 27 - update      52530 => loss: 0.205 (used GPU: 4391 MiB)
Epoch 27 - update      52560 => loss: 0.417 (used GPU: 4391 MiB)
Epoch 27 - update      52590 => loss: 0.464 (used GPU: 4391 MiB)
Epoch 27 - update      52620 => loss: 0.447 (used GPU: 4391 MiB)
Epoch 27 - update      52650 => loss: 0.513 (used GPU: 4391 MiB)
Epoch 27 - update      52680 => loss: 0.483 (used GPU: 4391 MiB)
Epoch 27 - update      52710 => loss: 0.849 (used GPU: 4391 MiB)
Epoch 27 - update      52740 => loss: 0.204 (used GPU: 4391 MiB)
Epoch 27 - update      52770 => loss: 0.397 (used GPU: 4391 MiB)
Epoch 27 - update      52800 => loss: 0.380 (used GPU: 4391 MiB)
Epoch 27 - update      52830 => loss: 0.358 (used GPU: 4391 MiB)
Epoch 27 - update      52860 => loss: 0.443 (used GPU: 4391 MiB)
Epoch 27 - update      52890 => loss: 0.611 (used GPU: 4391 MiB)
Epoch 27 - update      52920 => loss: 0.599 (used GPU: 4391 MiB)
Epoch 27 - update      52950 => loss: 0.541 (used GPU: 4391 MiB)
Epoch 27 - update      52980 => loss: 0.250 (used GPU: 4391 MiB)
Epoch 27 - update      53010 => loss: 0.256 (used GPU: 4391 MiB)
Epoch 27 - update      53040 => loss: 0.341 (used GPU: 4391 MiB)
Epoch 27 - update      53070 => loss: 0.737 (used GPU: 4391 MiB)
Epoch 27 - update      53100 => loss: 0.317 (used GPU: 4391 MiB)
Epoch 27 - update      53130 => loss: 0.199 (used GPU: 4391 MiB)
Epoch 27 - update      53160 => loss: 0.822 (used GPU: 4391 MiB)
Epoch 27 - update      53190 => loss: 0.779 (used GPU: 4391 MiB)
Epoch 27 - update      53220 => loss: 0.175 (used GPU: 4391 MiB)
Epoch 27 - update      53250 => loss: 0.342 (used GPU: 4391 MiB)
Epoch 27 - update      53280 => loss: 0.168 (used GPU: 4391 MiB)
Epoch 27 - update      53310 => loss: 0.180 (used GPU: 4391 MiB)
Epoch 27 - update      53340 => loss: 0.161 (used GPU: 4391 MiB)
Epoch 27 - update      53370 => loss: 0.528 (used GPU: 4391 MiB)
Epoch 27 - update      53400 => loss: 0.149 (used GPU: 4391 MiB)
Epoch 27 - update      53430 => loss: 0.733 (used GPU: 4391 MiB)
Epoch 27 - update      53460 => loss: 0.166 (used GPU: 4391 MiB)
Epoch 27 - update      53490 => loss: 0.239 (used GPU: 4391 MiB)
Epoch 27 - update      53520 => loss: 0.245 (used GPU: 4391 MiB)
Epoch 27 - update      53550 => loss: 0.193 (used GPU: 4391 MiB)
Epoch 27 - update      53580 => loss: 0.534 (used GPU: 4391 MiB)
Epoch 27 - update      53610 => loss: 0.289 (used GPU: 4391 MiB)
Epoch 27 - update      53640 => loss: 0.621 (used GPU: 4391 MiB)
Epoch 27 - update      53670 => loss: 0.250 (used GPU: 4391 MiB)
Epoch 27 - update      53700 => loss: 0.322 (used GPU: 4391 MiB)
Epoch 27 - update      53730 => loss: 0.279 (used GPU: 4391 MiB)
--> Epoch 27 finished with mean loss 0.54254
--> Overhead/Training/Evaluation: 0.13/2.80/0.00 mins (total: 2.94 mins)   (1100 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.96 sec, Scoring: 0.38 sec (339 sent/sec)
Validation 27 -> LOSS = 1.12
Validation 27 -> MRR = 84.96
Validation 27 -> BLEU = 54.30, 77.2/60.2/48.2/38.8 (BP=1.000, ratio=1.012, hyp_len=34296, ref_len=33879)
Early stopping patience: 2
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.96 @ validation 27
--> Best BLEU so far: 54.49 @ validation 19
Starting Epoch 28
Epoch 28 - update      53760 => loss: 0.230 (used GPU: 4391 MiB)
Epoch 28 - update      53790 => loss: 0.732 (used GPU: 4391 MiB)
Epoch 28 - update      53820 => loss: 0.101 (used GPU: 4391 MiB)
Epoch 28 - update      53850 => loss: 0.207 (used GPU: 4391 MiB)
Epoch 28 - update      53880 => loss: 0.150 (used GPU: 4391 MiB)
Epoch 28 - update      53910 => loss: 0.428 (used GPU: 4391 MiB)
Epoch 28 - update      53940 => loss: 0.459 (used GPU: 4391 MiB)
Epoch 28 - update      53970 => loss: 0.781 (used GPU: 4391 MiB)
Epoch 28 - update      54000 => loss: 0.378 (used GPU: 4391 MiB)
Epoch 28 - update      54030 => loss: 0.149 (used GPU: 4391 MiB)
Epoch 28 - update      54060 => loss: 0.497 (used GPU: 4391 MiB)
Epoch 28 - update      54090 => loss: 0.203 (used GPU: 4391 MiB)
Epoch 28 - update      54120 => loss: 0.477 (used GPU: 4391 MiB)
Epoch 28 - update      54150 => loss: 0.599 (used GPU: 4391 MiB)
Epoch 28 - update      54180 => loss: 0.119 (used GPU: 4391 MiB)
Epoch 28 - update      54210 => loss: 0.727 (used GPU: 4391 MiB)
Epoch 28 - update      54240 => loss: 0.361 (used GPU: 4391 MiB)
Epoch 28 - update      54270 => loss: 0.777 (used GPU: 4391 MiB)
Epoch 28 - update      54300 => loss: 0.130 (used GPU: 4391 MiB)
Epoch 28 - update      54330 => loss: 0.118 (used GPU: 4391 MiB)
Epoch 28 - update      54360 => loss: 0.283 (used GPU: 4391 MiB)
Epoch 28 - update      54390 => loss: 0.400 (used GPU: 4391 MiB)
Epoch 28 - update      54420 => loss: 0.308 (used GPU: 4391 MiB)
Epoch 28 - update      54450 => loss: 0.315 (used GPU: 4391 MiB)
Epoch 28 - update      54480 => loss: 0.327 (used GPU: 4391 MiB)
Epoch 28 - update      54510 => loss: 0.631 (used GPU: 4391 MiB)
Epoch 28 - update      54540 => loss: 0.435 (used GPU: 4391 MiB)
Epoch 28 - update      54570 => loss: 0.316 (used GPU: 4391 MiB)
Epoch 28 - update      54600 => loss: 0.138 (used GPU: 4391 MiB)
Epoch 28 - update      54630 => loss: 0.681 (used GPU: 4391 MiB)
Epoch 28 - update      54660 => loss: 0.124 (used GPU: 4391 MiB)
Epoch 28 - update      54690 => loss: 0.441 (used GPU: 4391 MiB)
Epoch 28 - update      54720 => loss: 0.871 (used GPU: 4391 MiB)
Epoch 28 - update      54750 => loss: 0.215 (used GPU: 4391 MiB)
Epoch 28 - update      54780 => loss: 0.625 (used GPU: 4391 MiB)
Epoch 28 - update      54810 => loss: 0.410 (used GPU: 4391 MiB)
Epoch 28 - update      54840 => loss: 0.232 (used GPU: 4391 MiB)
Epoch 28 - update      54870 => loss: 0.161 (used GPU: 4391 MiB)
Epoch 28 - update      54900 => loss: 0.375 (used GPU: 4391 MiB)
Epoch 28 - update      54930 => loss: 0.399 (used GPU: 4391 MiB)
Epoch 28 - update      54960 => loss: 0.547 (used GPU: 4391 MiB)
Epoch 28 - update      54990 => loss: 0.375 (used GPU: 4391 MiB)
Epoch 28 - update      55020 => loss: 0.131 (used GPU: 4391 MiB)
Epoch 28 - update      55050 => loss: 0.915 (used GPU: 4391 MiB)
Epoch 28 - update      55080 => loss: 0.449 (used GPU: 4391 MiB)
Epoch 28 - update      55110 => loss: 0.474 (used GPU: 4391 MiB)
Epoch 28 - update      55140 => loss: 0.339 (used GPU: 4391 MiB)
Epoch 28 - update      55170 => loss: 0.598 (used GPU: 4391 MiB)
Epoch 28 - update      55200 => loss: 0.350 (used GPU: 4391 MiB)
Epoch 28 - update      55230 => loss: 0.155 (used GPU: 4391 MiB)
Epoch 28 - update      55260 => loss: 0.208 (used GPU: 4391 MiB)
Epoch 28 - update      55290 => loss: 0.788 (used GPU: 4391 MiB)
Epoch 28 - update      55320 => loss: 0.161 (used GPU: 4391 MiB)
Epoch 28 - update      55350 => loss: 0.258 (used GPU: 4391 MiB)
Epoch 28 - update      55380 => loss: 0.434 (used GPU: 4391 MiB)
Epoch 28 - update      55410 => loss: 0.302 (used GPU: 4391 MiB)
Epoch 28 - update      55440 => loss: 0.241 (used GPU: 4391 MiB)
Epoch 28 - update      55470 => loss: 0.757 (used GPU: 4391 MiB)
Epoch 28 - update      55500 => loss: 0.348 (used GPU: 4391 MiB)
Epoch 28 - update      55530 => loss: 0.441 (used GPU: 4391 MiB)
Epoch 28 - update      55560 => loss: 0.206 (used GPU: 4391 MiB)
Epoch 28 - update      55590 => loss: 0.206 (used GPU: 4391 MiB)
Epoch 28 - update      55620 => loss: 0.371 (used GPU: 4391 MiB)
Epoch 28 - update      55650 => loss: 0.110 (used GPU: 4391 MiB)
Epoch 28 - update      55680 => loss: 1.005 (used GPU: 4391 MiB)
Epoch 28 - update      55710 => loss: 0.025 (used GPU: 4391 MiB)
Epoch 28 - update      55740 => loss: 0.265 (used GPU: 4391 MiB)
--> Epoch 28 finished with mean loss 0.53925
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.94 mins)   (1101 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.93 sec, Scoring: 0.38 sec (340 sent/sec)
Validation 28 -> LOSS = 1.12
Validation 28 -> MRR = 84.95
Validation 28 -> BLEU = 54.26, 77.2/60.2/48.1/38.8 (BP=1.000, ratio=1.011, hyp_len=34242, ref_len=33879)
** Learning rate changed -> 2.5e-05
Early stopping patience: 1
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.96 @ validation 27
--> Best BLEU so far: 54.49 @ validation 19
Starting Epoch 29
Epoch 29 - update      55770 => loss: 0.658 (used GPU: 4391 MiB)
Epoch 29 - update      55800 => loss: 0.748 (used GPU: 4391 MiB)
Epoch 29 - update      55830 => loss: 0.162 (used GPU: 4391 MiB)
Epoch 29 - update      55860 => loss: 0.142 (used GPU: 4391 MiB)
Epoch 29 - update      55890 => loss: 0.822 (used GPU: 4391 MiB)
Epoch 29 - update      55920 => loss: 0.124 (used GPU: 4391 MiB)
Epoch 29 - update      55950 => loss: 0.880 (used GPU: 4391 MiB)
Epoch 29 - update      55980 => loss: 0.651 (used GPU: 4391 MiB)
Epoch 29 - update      56010 => loss: 0.771 (used GPU: 4391 MiB)
Epoch 29 - update      56040 => loss: 0.629 (used GPU: 4391 MiB)
Epoch 29 - update      56070 => loss: 0.350 (used GPU: 4391 MiB)
Epoch 29 - update      56100 => loss: 0.549 (used GPU: 4391 MiB)
Epoch 29 - update      56130 => loss: 0.203 (used GPU: 4391 MiB)
Epoch 29 - update      56160 => loss: 0.219 (used GPU: 4391 MiB)
Epoch 29 - update      56190 => loss: 0.230 (used GPU: 4391 MiB)
Epoch 29 - update      56220 => loss: 0.315 (used GPU: 4391 MiB)
Epoch 29 - update      56250 => loss: 0.791 (used GPU: 4391 MiB)
Epoch 29 - update      56280 => loss: 0.157 (used GPU: 4391 MiB)
Epoch 29 - update      56310 => loss: 0.159 (used GPU: 4391 MiB)
Epoch 29 - update      56340 => loss: 0.760 (used GPU: 4391 MiB)
Epoch 29 - update      56370 => loss: 0.312 (used GPU: 4391 MiB)
Epoch 29 - update      56400 => loss: 0.533 (used GPU: 4391 MiB)
Epoch 29 - update      56430 => loss: 0.531 (used GPU: 4391 MiB)
Epoch 29 - update      56460 => loss: 0.350 (used GPU: 4391 MiB)
Epoch 29 - update      56490 => loss: 0.341 (used GPU: 4391 MiB)
Epoch 29 - update      56520 => loss: 0.546 (used GPU: 4391 MiB)
Epoch 29 - update      56550 => loss: 0.238 (used GPU: 4391 MiB)
Epoch 29 - update      56580 => loss: 0.354 (used GPU: 4391 MiB)
Epoch 29 - update      56610 => loss: 0.387 (used GPU: 4391 MiB)
Epoch 29 - update      56640 => loss: 0.266 (used GPU: 4391 MiB)
Epoch 29 - update      56670 => loss: 0.201 (used GPU: 4391 MiB)
Epoch 29 - update      56700 => loss: 0.604 (used GPU: 4391 MiB)
Epoch 29 - update      56730 => loss: 0.809 (used GPU: 4391 MiB)
Epoch 29 - update      56760 => loss: 0.317 (used GPU: 4391 MiB)
Epoch 29 - update      56790 => loss: 0.624 (used GPU: 4391 MiB)
Epoch 29 - update      56820 => loss: 0.106 (used GPU: 4391 MiB)
Epoch 29 - update      56850 => loss: 0.319 (used GPU: 4391 MiB)
Epoch 29 - update      56880 => loss: 0.833 (used GPU: 4391 MiB)
Epoch 29 - update      56910 => loss: 0.439 (used GPU: 4391 MiB)
Epoch 29 - update      56940 => loss: 0.243 (used GPU: 4391 MiB)
Epoch 29 - update      56970 => loss: 0.525 (used GPU: 4391 MiB)
Epoch 29 - update      57000 => loss: 0.255 (used GPU: 4391 MiB)
Epoch 29 - update      57030 => loss: 0.770 (used GPU: 4391 MiB)
Epoch 29 - update      57060 => loss: 0.256 (used GPU: 4391 MiB)
Epoch 29 - update      57090 => loss: 0.657 (used GPU: 4391 MiB)
Epoch 29 - update      57120 => loss: 0.230 (used GPU: 4391 MiB)
Epoch 29 - update      57150 => loss: 0.062 (used GPU: 4391 MiB)
Epoch 29 - update      57180 => loss: 0.334 (used GPU: 4391 MiB)
Epoch 29 - update      57210 => loss: 0.131 (used GPU: 4391 MiB)
Epoch 29 - update      57240 => loss: 0.679 (used GPU: 4391 MiB)
Epoch 29 - update      57270 => loss: 0.150 (used GPU: 4391 MiB)
Epoch 29 - update      57300 => loss: 0.600 (used GPU: 4391 MiB)
Epoch 29 - update      57330 => loss: 0.176 (used GPU: 4391 MiB)
Epoch 29 - update      57360 => loss: 0.248 (used GPU: 4391 MiB)
Epoch 29 - update      57390 => loss: 0.136 (used GPU: 4391 MiB)
Epoch 29 - update      57420 => loss: 0.381 (used GPU: 4391 MiB)
Epoch 29 - update      57450 => loss: 0.211 (used GPU: 4391 MiB)
Epoch 29 - update      57480 => loss: 0.439 (used GPU: 4391 MiB)
Epoch 29 - update      57510 => loss: 0.347 (used GPU: 4391 MiB)
Epoch 29 - update      57540 => loss: 0.328 (used GPU: 4391 MiB)
Epoch 29 - update      57570 => loss: 0.572 (used GPU: 4391 MiB)
Epoch 29 - update      57600 => loss: 0.527 (used GPU: 4391 MiB)
Epoch 29 - update      57630 => loss: 0.316 (used GPU: 4391 MiB)
Epoch 29 - update      57660 => loss: 1.292 (used GPU: 4391 MiB)
Epoch 29 - update      57690 => loss: 0.169 (used GPU: 4391 MiB)
Epoch 29 - update      57720 => loss: 0.630 (used GPU: 4391 MiB)
--> Epoch 29 finished with mean loss 0.53091
--> Overhead/Training/Evaluation: 0.14/2.80/0.00 mins (total: 2.93 mins)   (1103 samples/sec)
Computing evaluation loss...
Performing beam search (beam_size:5)
Beam Search: 5.93 sec, Scoring: 0.38 sec (341 sent/sec)
Validation 29 -> LOSS = 1.12
Validation 29 -> MRR = 84.95
Validation 29 -> BLEU = 54.38, 77.3/60.3/48.2/38.9 (BP=1.000, ratio=1.009, hyp_len=34198, ref_len=33879)
Early stopping patience: 0
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.96 @ validation 27
--> Best BLEU so far: 54.49 @ validation 19
Starting Epoch 30
Early stopped.
--> This is model: adaptation2048-dec320-emb320-enc320-adam_4e-04-do_ctx_0.3-do_emb_0.3-do_out_0.3-r7692d
--> Best LOSS so far: 1.09 @ validation 11
--> Best MRR so far: 84.96 @ validation 27
--> Best BLEU so far: 54.49 @ validation 19
Training finished on 05-09-2018 04:01
